<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Android-2 - ldrx30</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="
å®‰å“æ–°äººğŸ˜‹
" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Android-2" />
<meta property="og:description" content="
å®‰å“æ–°äººğŸ˜‹
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/android-2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-10-18T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Android-2"/>
<meta name="twitter:description" content="
å®‰å“æ–°äººğŸ˜‹
"/>
<script src="http://localhost:1313/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="http://localhost:1313/css/dark.d22e2a2879d933a4b781535fc4c4c716e9f9d35ea4986dd0cbabda82effc4bdd.css"  disabled />
	

	
	
		<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script>
	

	
	
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

		
		<script>
			document.addEventListener("DOMContentLoaded", function() {
					renderMathInElement(document.body, {
							delimiters: [
									{left: "$$", right: "$$", display: true},
									{left: "$", right: "$", display: false}
							]
					});
			});
			</script>
	

	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">ldrx30</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/about">About</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="http://localhost:1313/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Android-2</h1>
			<div class="meta">Posted on Oct 18, 2023</div>
		</div>
		

		

		<section class="body">
			<blockquote>
<p>å®‰å“æ–°äººğŸ˜‹</p>
</blockquote>
<h2 id="hello-world">Hello World</h2>
<ol>
<li>Android Studio åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œç­‰å¾…gradle</li>
<li>æƒ³è¦runèµ·æ¥ï¼Œåˆ›å»ºä¸€ä¸ªdeviceã€‚åœ¨Android Studioé¡¶æ ï¼Œdevice manager -&gt; create.</li>
</ol>
<ul>
<li>ä»€ä¹ˆéƒ½å…ˆé€‰ç¬¬ä¸€ä¸ªï¼Œç¼ºä»€ä¹ˆä¸œè¥¿ä½¿ç”¨IDEä¸‹è½½</li>
</ul>
<h3 id="activity">Activity</h3>
<p>Activityä»£è¡¨äº†ä¸€ä¸ªå…·æœ‰ç”¨æˆ·ç•Œé¢çš„å•ä¸€å±å¹•</p>
<p>Android åˆå§‹åŒ–æ˜¯é€šè¿‡ Activity ä¸­çš„ onCreate() å›è°ƒçš„è°ƒç”¨å¼€å§‹çš„ã€‚å­˜åœ¨æœ‰ä¸€åºåˆ—çš„å›è°ƒæ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªæ´»åŠ¨ï¼ŒåŒæ—¶æœ‰ä¸€åºåˆ—çš„æ–¹æ³•æ¥å…³é—­æ´»åŠ¨</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>onCreate()</td>
<td>è¿™æ˜¯ç¬¬ä¸€ä¸ªå›è°ƒï¼Œåœ¨æ´»åŠ¨ç¬¬ä¸€æ¬¡åˆ›å»ºæ—¶è°ƒç”¨</td>
</tr>
<tr>
<td>onStart()</td>
<td>è¿™ä¸ªå›è°ƒåœ¨æ´»åŠ¨ä¸ºç”¨æˆ·å¯è§æ—¶è¢«è°ƒç”¨</td>
</tr>
<tr>
<td>onResume()</td>
<td>è¿™ä¸ªå›è°ƒåœ¨åº”ç”¨ç¨‹åºä¸ç”¨æˆ·å¼€å§‹å¯äº¤äº’çš„æ—¶å€™è°ƒç”¨</td>
</tr>
<tr>
<td>onPause()</td>
<td>è¢«æš‚åœçš„æ´»åŠ¨æ— æ³•æ¥å—ç”¨æˆ·è¾“å…¥ï¼Œä¸èƒ½æ‰§è¡Œä»»ä½•ä»£ç ã€‚å½“å‰æ´»åŠ¨å°†è¦è¢«æš‚åœï¼Œä¸Šä¸€ä¸ªæ´»åŠ¨å°†è¦è¢«æ¢å¤æ—¶è°ƒç”¨</td>
</tr>
<tr>
<td>onStop()</td>
<td>å½“æ´»åŠ¨ä¸åœ¨å¯è§æ—¶è°ƒç”¨</td>
</tr>
<tr>
<td>onDestroy()</td>
<td>å½“æ´»åŠ¨è¢«ç³»ç»Ÿé”€æ¯ä¹‹å‰è°ƒç”¨</td>
</tr>
<tr>
<td>onRestart()</td>
<td>å½“æ´»åŠ¨è¢«åœæ­¢ä»¥åé‡æ–°æ‰“å¼€æ—¶è°ƒç”¨</td>
</tr>
</tbody>
</table>
<h3 id="bundle">bundle</h3>
<p>Bundleä¸»è¦ç”¨äº<strong>ä¼ é€’æ•°æ®</strong>ï¼šå®ƒä¿å­˜çš„æ•°æ®ï¼Œæ˜¯ä»¥key-value(é”®å€¼å¯¹)çš„å½¢å¼å­˜åœ¨çš„ã€‚</p>
<p>æˆ‘ä»¬ç»å¸¸ä½¿ç”¨<em>Bundleåœ¨Activityä¹‹é—´ä¼ é€’æ•°æ®</em>ï¼Œä¼ é€’çš„æ•°æ®å¯ä»¥æ˜¯booleanã€byteã€intã€longã€floatã€doubleã€stringç­‰åŸºæœ¬ç±»å‹æˆ–å®ƒä»¬å¯¹åº”çš„æ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡æˆ–å¯¹è±¡æ•°ç»„ã€‚å½“Bundleä¼ é€’çš„æ˜¯å¯¹è±¡æˆ–å¯¹è±¡æ•°ç»„æ—¶ï¼Œå®ç°SerializableÂ æˆ– Parcelable æ¥å£ã€‚</p>
<h3 id="å¸¸è§ç»„ä»¶">å¸¸è§ç»„ä»¶</h3>
<ol>
<li>onclickï¼šç‚¹å‡»äº‹ä»¶</li>
<li>buttonï¼šæŒ‰é’®</li>
<li>EditTextï¼š
ç¼–è¾‘æ–‡æœ¬æ§ä»¶
ç¼–è¾‘æ¡†ï¼ˆEditTextï¼‰æ˜¯TextView çš„å­ç±»ï¼Œåœ¨TextView çš„åŸºç¡€ä¸Šå¢åŠ äº†æ–‡æœ¬ç¼–è¾‘åŠŸèƒ½ï¼Œç”¨äºå¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œä¾‹å¦‚ç™»å½•æ¡†ç­‰ï¼Œæ˜¯éå¸¸å¸¸ç”¨çš„ç»„ä»¶ã€‚</li>
</ol>
<h3 id="apk">APK</h3>
<p>android åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®ï¼Œæ‰“å¼€hello xxxã€‚å…ˆä¸åœ¨æ„ç»†èŠ‚ï¼Œç›´æ¥ç¼–è¯‘ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œï¼ˆåˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿå™¨ï¼‰</p>
<p>æ‰“åŒ…æˆAPKæ–‡ä»¶ï¼š</p>
<ol>
<li>Build -&gt; Build Bundles/Apks -&gt; Build APKs</li>
<li>Build -&gt; Make Project ç„¶ååœ¨æ‰§è¡Œ1</li>
<li>è·¯å¾„ app/build/outputs/apk</li>
</ol>
<p>å¦‚æœæ˜¯debugç‰ˆæœ¬ï¼Œéœ€è¦æ›´æ”¹ build variants ä¸º release</p>
<p>ç„¶åå°±å¯ä»¥åœ¨jadxä¸­åç¼–è¯‘çœ‹çœ‹ã€‚</p>
<h2 id="native">Native</h2>
<ol>
<li>Android Studioé€‰æ‹©åˆ›å»ºä¸€ä¸ªnative C++ é¡¹ç›®ï¼Œç­‰å¾…gradle</li>
<li>å‡ºç°ä¸€ä¸ª <code>cpp</code> çš„æ–‡ä»¶å¤¹ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦å†™çš„åº“ã€‚åŒæ—¶å­˜åœ¨javaæ–‡ä»¶å¤¹</li>
</ol>
<ul>
<li>deviceåˆ›å»ºæˆ–è€…ä½¿ç”¨å·²ç»å­˜åœ¨çš„</li>
</ul>
<ol start="3">
<li>Javaå±‚å¯¼å…¥åº“</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">static</span> { System.<span style="color:#50fa7b">loadLibrary</span>(<span style="color:#f1fa8c">&#34;xxx&#34;</span>); }
</span></span></code></pre></div><ol start="4">
<li>åœ¨Javaä»£ç ä¸­å‡ºç°å¦‚ä¸‹çš„æ–¹æ³•</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">native</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">demo</span>();
</span></span></code></pre></div><h3 id="jnih">jni.h</h3>
<blockquote>
<p>åœ¨android ndk ä¸‹å¯ä»¥æ‰¾åˆ°ï¼Œç›´æ¥é‡‡ä½¿ç”¨ find å‘½ä»¤æ‰¾ã€‚</p>
</blockquote>
<ol>
<li>æŸäº›ç±»å‹</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span> Â  Â  Â  Â  Â  jobject;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> jobject Â  Â  Â  Â  jclass;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> jobject Â  Â  Â  Â  jstring;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> jobject Â  Â  Â  Â  jarray;
</span></span></code></pre></div><ol start="2">
<li>JNIEnv å’Œ JavaVMå£°æ˜ï¼Œåœ¨Cå’ŒC++ ç”¨æ³•ä¸å¤ªç›¸åŒã€‚</li>
</ol>
<p>JNI å®šä¹‰äº†ä¸¤ä¸ªå…³é”®æ•°æ®ç»“æ„ï¼Œå³<code>JavaVM</code>å’Œ<code>JNIEnv</code>ã€‚ä¸¤è€…æœ¬è´¨ä¸Šéƒ½æ˜¯æŒ‡å‘å‡½æ•°è¡¨çš„äºŒçº§æŒ‡é’ˆã€‚ï¼ˆåœ¨ C++ ç‰ˆæœ¬ä¸­ï¼Œå®ƒä»¬æ˜¯ä¸€äº›ç±»ï¼Œè¿™äº›ç±»å…·æœ‰æŒ‡å‘å‡½æ•°è¡¨çš„æŒ‡é’ˆï¼Œå¹¶å…·æœ‰æ¯ä¸ªé€šè¿‡è¯¥å‡½æ•°è¡¨é—´æ¥è°ƒç”¨çš„ JNI å‡½æ•°çš„æˆå‘˜å‡½æ•°ã€‚ï¼‰JavaVM æä¾›<code>è°ƒç”¨æ¥å£</code>å‡½æ•°ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨æ­¤ç±»æ¥å‡½æ•°åˆ›å»ºå’Œé”€æ¯ JavaVMã€‚ç†è®ºä¸Šï¼Œæ¯ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ª JavaVMï¼Œä½† Android åªå…è®¸æœ‰ä¸€ä¸ªã€‚</p>
<p>JNIEnv æä¾›äº†å¤§éƒ¨åˆ† JNI å‡½æ•°ã€‚åŸç”Ÿå‡½æ•°éƒ½ä¼šæ”¶åˆ° JNIEnv ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">_JNIEnv</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">_JavaVM</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> <span style="color:#ff79c6">const</span> <span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">JNINativeInterface</span><span style="color:#ff79c6">*</span> C_JNIEnv;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">#if defined(__cplusplus)
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6"></span><span style="color:#ff79c6">typedef</span> _JNIEnv JNIEnv;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> _JavaVM JavaVM;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">#else
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6"></span><span style="color:#ff79c6">typedef</span> <span style="color:#ff79c6">const</span> <span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">JNINativeInterface</span><span style="color:#ff79c6">*</span> JNIEnv;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> <span style="color:#ff79c6">const</span> <span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">JNIInvokeInterface</span><span style="color:#ff79c6">*</span> JavaVM;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">#endif
</span></span></span></code></pre></div><ol start="3">
<li>JavaVM åŸå‹</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">_JavaVM</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">const</span> <span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">JNIInvokeInterface</span><span style="color:#ff79c6">*</span> functions;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">#if defined(__cplusplus)
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6"></span>    jint <span style="color:#50fa7b">DestroyJavaVM</span>()
</span></span><span style="display:flex;"><span>    { <span style="color:#ff79c6">return</span> functions<span style="color:#ff79c6">-&gt;</span>DestroyJavaVM(<span style="color:#ff79c6">this</span>); }
</span></span><span style="display:flex;"><span>    jint <span style="color:#50fa7b">AttachCurrentThread</span>(JNIEnv<span style="color:#ff79c6">**</span> p_env, <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span> thr_args)
</span></span><span style="display:flex;"><span>    { <span style="color:#ff79c6">return</span> functions<span style="color:#ff79c6">-&gt;</span>AttachCurrentThread(<span style="color:#ff79c6">this</span>, p_env, thr_args); }
</span></span><span style="display:flex;"><span>    jint <span style="color:#50fa7b">DetachCurrentThread</span>()
</span></span><span style="display:flex;"><span>    { <span style="color:#ff79c6">return</span> functions<span style="color:#ff79c6">-&gt;</span>DetachCurrentThread(<span style="color:#ff79c6">this</span>); }
</span></span><span style="display:flex;"><span>    jint <span style="color:#50fa7b">GetEnv</span>(<span style="color:#8be9fd">void</span><span style="color:#ff79c6">**</span> env, jint version)
</span></span><span style="display:flex;"><span>    { <span style="color:#ff79c6">return</span> functions<span style="color:#ff79c6">-&gt;</span>GetEnv(<span style="color:#ff79c6">this</span>, env, version); }
</span></span><span style="display:flex;"><span>    jint <span style="color:#50fa7b">AttachCurrentThreadAsDaemon</span>(JNIEnv<span style="color:#ff79c6">**</span> p_env, <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span> thr_args)
</span></span><span style="display:flex;"><span>    { <span style="color:#ff79c6">return</span> functions<span style="color:#ff79c6">-&gt;</span>AttachCurrentThreadAsDaemon(<span style="color:#ff79c6">this</span>, p_env, thr_args); }
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">#endif </span><span style="color:#6272a4">/*__cplusplus*/</span><span style="color:#ff79c6">
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">JNIInvokeInterface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span>       reserved0;
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span>       reserved1;
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span>       reserved2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    jint        (<span style="color:#ff79c6">*</span>DestroyJavaVM)(JavaVM<span style="color:#ff79c6">*</span>);
</span></span><span style="display:flex;"><span>    jint        (<span style="color:#ff79c6">*</span>AttachCurrentThread)(JavaVM<span style="color:#ff79c6">*</span>, JNIEnv<span style="color:#ff79c6">**</span>, <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span>);
</span></span><span style="display:flex;"><span>    jint        (<span style="color:#ff79c6">*</span>DetachCurrentThread)(JavaVM<span style="color:#ff79c6">*</span>);
</span></span><span style="display:flex;"><span>    jint        (<span style="color:#ff79c6">*</span>GetEnv)(JavaVM<span style="color:#ff79c6">*</span>, <span style="color:#8be9fd">void</span><span style="color:#ff79c6">**</span>, jint);
</span></span><span style="display:flex;"><span>    jint        (<span style="color:#ff79c6">*</span>AttachCurrentThreadAsDaemon)(JavaVM<span style="color:#ff79c6">*</span>, JNIEnv<span style="color:#ff79c6">**</span>, <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ol start="4">
<li>JNIEnv</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">JNINativeInterface</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#6272a4">// xxx æ¯”è¾ƒå¤š
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>}
</span></span></code></pre></div><ol start="5">
<li>native methodï¼Œç­¾åæœ‰ä¸ªå…·ä½“çš„è¡¨</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> <span style="color:#ff79c6">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">const</span> <span style="color:#8be9fd">char</span><span style="color:#ff79c6">*</span> name;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">const</span> <span style="color:#8be9fd">char</span><span style="color:#ff79c6">*</span> signature;
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span>       fnPtr;
</span></span><span style="display:flex;"><span>} JNINativeMethod;
</span></span></code></pre></div><h3 id="é™æ€æ³¨å†Œ">é™æ€æ³¨å†Œ</h3>
<ol>
<li>é™æ€æ³¨å†Œçš„å‡½æ•°åä¸€èˆ¬ä¸º <code>Java_åŒ…å_ç±»å_å‡½æ•°å</code> å°†åŒ…åä¸­çš„ <code>.</code> æ›¿æ¢ä¸º <code>_</code> å°±æ˜¯nativeå±‚å‡½æ•°çš„åç§°</li>
<li>å‡½æ•°ï¼šä»<code>jni.h</code> å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€ä¸ªæ˜¯JNIEnvï¼Œç¬¬äºŒä¸ªä¸ºjclassï¼Œç„¶åå°±æ˜¯Javaå±‚ä»£ç çš„å‚æ•°</li>
<li>android studio åˆ›å»ºä¸€ä¸ªnative C++ é»˜è®¤ä¸ºé™æ€æ³¨å†Œ</li>
</ol>
<p>native-lib.cpp</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;jni.h&gt;</span><span style="color:#ff79c6">  
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;string&gt;</span><span style="color:#ff79c6">  
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6"></span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">extern</span> <span style="color:#f1fa8c">&#34;C&#34;</span> 
</span></span><span style="display:flex;"><span>JNIEXPORT jstring JNICALL  
</span></span><span style="display:flex;"><span>Java_com_learn_native_1lib_MainActivity_stringFromJNI(  
</span></span><span style="display:flex;"><span>        JNIEnv<span style="color:#ff79c6">*</span> env,  
</span></span><span style="display:flex;"><span>        jobject <span style="color:#6272a4">/* this */</span>) {  
</span></span><span style="display:flex;"><span>    std<span style="color:#ff79c6">::</span>string hello <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Hello from C++&#34;</span>;  
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> env<span style="color:#ff79c6">-&gt;</span>NewStringUTF(hello.c_str());  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>javaå±‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> com.learn.native_lib;  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> androidx.appcompat.app.AppCompatActivity;  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> android.os.Bundle;  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> android.widget.TextView;  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> com.learn.native_lib.databinding.ActivityMainBinding;  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">MainActivity</span> <span style="color:#8be9fd;font-style:italic">extends</span> AppCompatActivity {  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// Used to load the &#39;native_lib&#39; library on application startup.  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">static</span> {  
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">loadLibrary</span>(<span style="color:#f1fa8c">&#34;native_lib&#34;</span>);  
</span></span><span style="display:flex;"><span>    }  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> ActivityMainBinding binding;  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    @Override  
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">protected</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">onCreate</span>(Bundle savedInstanceState) {  
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">super</span>.<span style="color:#50fa7b">onCreate</span>(savedInstanceState);  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>        binding <span style="color:#ff79c6">=</span> ActivityMainBinding.<span style="color:#50fa7b">inflate</span>(getLayoutInflater());  
</span></span><span style="display:flex;"><span>        setContentView(binding.<span style="color:#50fa7b">getRoot</span>());  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// Example of a call to a native method  </span>
</span></span><span style="display:flex;"><span>        TextView tv <span style="color:#ff79c6">=</span> binding.<span style="color:#50fa7b">sampleText</span>;  
</span></span><span style="display:flex;"><span>        tv.<span style="color:#50fa7b">setText</span>(stringFromJNI());  
</span></span><span style="display:flex;"><span>    }  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">/**  
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * A native method that is implemented by the &#39;native_lib&#39; native library,     
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * which is packaged with this application.     
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * */</span>    
</span></span><span style="display:flex;"><span>     <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">native</span> String <span style="color:#50fa7b">stringFromJNI</span>();  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ¨¡æ‹Ÿå™¨è¿è¡Œ + jadxåç¼–è¯‘ + ida æ‰“å¼€soæ–‡ä»¶</p>
<h3 id="åŠ¨æ€æ³¨å†Œ">åŠ¨æ€æ³¨å†Œ</h3>
<ol>
<li>å‡½æ•°åä¸ç”¨è¿™ä¹ˆé•¿ï¼Œä½†æ˜¯ä¸€èˆ¬ä¼šä¸Javaå±‚çš„åç§°ç›¸åŒï¼Œæ–¹ä¾¿å¼€å‘</li>
<li>JNI_Onload å‡½æ•°ï¼ŒåŠ¨æ€æ³¨å†Œ</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">#define classname &#34;com/learn/native_demo/MainActivity&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">static</span> jclass myClass;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jint <span style="color:#50fa7b">JNI_OnLoad</span>(JavaVM<span style="color:#ff79c6">*</span> vm, <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span> reserved) {
</span></span><span style="display:flex;"><span>	JNIEnv<span style="color:#ff79c6">*</span> env <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">NULL</span>; 
</span></span><span style="display:flex;"><span>    jint result <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">//1. ä»JavaVMè·å–JNIEnvï¼Œè¿™é‡Œä½¿ç”¨1.4çš„ç‰ˆæœ¬
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">if</span>(vm<span style="color:#ff79c6">-&gt;</span>GetEnv((<span style="color:#8be9fd">void</span> <span style="color:#ff79c6">**</span>) <span style="color:#ff79c6">&amp;</span>env, JNI_VERSION_1_4) <span style="color:#ff79c6">!=</span> JNI_OK) { 
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 2. è·å–æ˜ å°„çš„javaç±»
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    myClass <span style="color:#ff79c6">=</span> env<span style="color:#ff79c6">-&gt;</span>FindClass(className);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span>(myClass <span style="color:#ff79c6">==</span> <span style="color:#8be9fd;font-style:italic">NULL</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      printf(<span style="color:#f1fa8c">&#34;cannot get class:%s</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, className);
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 2. é€šè¿‡RegisterNativesæ–¹æ³•åŠ¨æ€æ³¨å†Œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">if</span>(env<span style="color:#ff79c6">-&gt;</span>RegisterNatives(myClass, gMethods, <span style="color:#ff79c6">sizeof</span>(gMethods)<span style="color:#ff79c6">/</span><span style="color:#ff79c6">sizeof</span>(gMethods[<span style="color:#bd93f9">0</span>])) <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      printf(<span style="color:#f1fa8c">&#34;register native method failed!</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">return</span> JNI_FALSE;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 4. è¿”å›ç‰ˆæœ¬ï¼Œå¦åˆ™åŠ è½½ä¼šå¤±è´¥ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">return</span> JNI_VERSION_1_4;                  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="3">
<li>åŠ¨æ€æ³¨å†Œï¼Œä¸»è¦é JNIEnvçš„RegisterNativeså‡½æ•°</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>jint RegisterNatives(jclass clazz, <span style="color:#ff79c6">const</span> JNINativeMethod<span style="color:#ff79c6">*</span> methods,
</span></span><span style="display:flex;"><span>        jint nMethods)
</span></span></code></pre></div><ol start="4">
<li>æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ JNINativeMethod æ•°ç»„</li>
</ol>
<ul>
<li><code>getNativeString</code>ä¸ºJavaç±»ä¸­å®šä¹‰çš„Nativeæ–¹æ³•åã€‚</li>
<li><code>()Ljava/lang/String;</code> ä¸ºæ–¹æ³•çš„ç­¾åï¼Œ <code>()</code>è¡¨ç¤ºè¯¥æ–¹æ³•æ— å‚æ•°</li>
<li><code>reinterpret_cast&lt;void*&gt;(getString)</code> ä¸ºNativeå®ç°çš„æ–¹æ³•åã€‚è¿™é‡Œå¼ºåˆ¶è½¬æ¢æˆäº†å‡½æ•°æŒ‡é’ˆã€‚</li>
<li>è¿™äº›å‡½æ•°éƒ½éœ€è¦æˆ‘ä»¬å®ç°</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">static</span> JNINativeMethod gMethods[] <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>        {<span style="color:#f1fa8c">&#34;getNativeString&#34;</span>, <span style="color:#f1fa8c">&#34;()Ljava/lang/String;&#34;</span>, <span style="color:#ff79c6">reinterpret_cast</span><span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd">void</span><span style="color:#ff79c6">*&gt;</span>(getString)}
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="smali-è¯­æ³•">smali è¯­æ³•</h2>
<p>Dalvik è™šæ‹Ÿæœºï¼šDalvik æ˜¯ Google ä¸“é—¨ä¸º Android å¹³å°è®¾è®¡çš„è™šæ‹Ÿæœºã€‚è™½ç„¶ Android ç¨‹åºå¯ä»¥ä½¿ç”¨ Java è¯­è¨€æ¥è¿›è¡Œå¼€å‘ï¼Œä½† Dalvik VM å’Œ Java VM æ˜¯ä¸¤æ¬¾ä¸åŒçš„è™šæ‹Ÿæœºã€‚Dalvik VM åŸºäºå¯„å­˜å™¨ï¼Œè€Œ Java VM åŸºäºæ ˆ ã€‚Dalvik VM æœ‰ä¸“é—¨çš„æ–‡ä»¶æ‰§è¡Œæ ¼å¼ dex (Dalvik Executable)ï¼Œè€Œ Java VM åˆ™æ‰§è¡Œçš„æ˜¯ Java å­—èŠ‚ç ã€‚DVM æ¯” JVM é€Ÿåº¦æ›´å¿«ï¼Œå ç”¨çš„ç©ºé—´æ›´å°‘ã€‚</p>
<p>ä¸å¿…è¦æ­»è®°ç¡¬èƒŒï¼Œä½¿ç”¨æ—¶æŸ¥è¡¨ï¼Œç”¨ç€å°±ç†Ÿæ‚‰äº†</p>
<p><a href="https://ctf-wiki.org/android/basic_operating_mechanism/java_layer/smali/smali/">Smali - CTF Wiki (ctf-wiki.org)</a></p>
<h2 id="firda">Firda</h2>
<blockquote>
<p>åªèƒ½è¯´å¤šçœ‹å®˜æ–¹æ–‡æ¡£</p>
</blockquote>
<p>å‘½ä»¤ä½¿ç”¨</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#6272a4"># æ—§ç‰ˆ </span>
</span></span><span style="display:flex;"><span>frida -U &lt;package_name&gt; -l hook.js  --no-pause
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æ–°ç‰ˆé»˜è®¤ä¸ä¼šæš‚åœï¼Œä½¿ç”¨--pause æš‚åœ ã€‚</span>
</span></span><span style="display:flex;"><span>frida-ps -Uai  // è·å¾—åç§°
</span></span><span style="display:flex;"><span>frida -U  &lt;name&gt; -l hook.js 
</span></span></code></pre></div><p>æŸäº›æ–¹æ³•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#6272a4">// è·å–ç¯å¢ƒå˜é‡ï¼Œå°±æ˜¯è·å– JNIEnv ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥è°ƒç”¨JNIEnvçš„æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>Java.vm.getEnv()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">// ç±»å‹è½¬åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>hexdump()
</span></span><span style="display:flex;"><span>readCString() 
</span></span><span style="display:flex;"><span>toInt32()
</span></span></code></pre></div><h3 id="native-hook">native hook</h3>
<ol>
<li>è·å¾—soåŸºå€</li>
<li>è·å¾—å‡½æ•°åŸºå€ï¼Œè¿›è¡Œattachï¼Œä¸¤ä¸ªæ–¹æ³•ï¼Œè¿›å…¥å‡½æ•°(onEnter)å’Œé€€å‡ºå‡½æ•°(onLeave)çš„æ“ä½œ</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>Java.perform(() =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">let</span> lib_name <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;xxx.so&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">let</span> func_offset <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0x114514</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">let</span> libc_base <span style="color:#ff79c6">=</span> Module.findBaseAddress(lib_name);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  console.log(<span style="color:#f1fa8c">&#34;libc base: &#34;</span> <span style="color:#ff79c6">+</span> libc_base);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#6272a4">// ä¸€èˆ¬soå±‚å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯JniEnvï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯jclass
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd;font-style:italic">let</span> func_addr <span style="color:#ff79c6">=</span> libc_base.add(func_offset);
</span></span><span style="display:flex;"><span>  Interceptor.attach(func_addr, {
</span></span><span style="display:flex;"><span>    onEnter<span style="color:#ff79c6">:</span> <span style="color:#8be9fd;font-style:italic">function</span> (args) {
</span></span><span style="display:flex;"><span>      console.log(<span style="color:#f1fa8c">&#34;start function&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#6272a4">// console.log(&#34;args[0] = \n&#34; + hexdump(args[0]));
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>      <span style="color:#6272a4">// console.log(&#34;args[1] = \n&#34; + hexdump(args[1]));
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>      console.log(<span style="color:#f1fa8c">&#34;args[2] = \n&#34;</span> <span style="color:#ff79c6">+</span> hexdump(args[<span style="color:#bd93f9">2</span>]));
</span></span><span style="display:flex;"><span>      console.log(<span style="color:#f1fa8c">&#34;args[3] = \n&#34;</span> <span style="color:#ff79c6">+</span> hexdump(args[<span style="color:#bd93f9">3</span>]));
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    onLeave<span style="color:#ff79c6">:</span> <span style="color:#8be9fd;font-style:italic">function</span> (retval) {
</span></span><span style="display:flex;"><span>      console.log(<span style="color:#f1fa8c">&#34;function return&#34;</span>);
</span></span><span style="display:flex;"><span>      console.log(<span style="color:#f1fa8c">&#34;return =&gt; &#34;</span> <span style="color:#ff79c6">+</span> hexdump(retval));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h3 id="inline-hook">inline hook</h3>
<blockquote>
<p>å¡æ­»çš„å‡ ç‡æ¯”è¾ƒé«˜</p>
</blockquote>
<ol>
<li>è·å¾—æŒ‡ä»¤çš„åœ°å€</li>
<li>æ‰“å°ä¸Šä¸‹æ–‡ context</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>  Interceptor.attach(addr, {
</span></span><span style="display:flex;"><span>    onEnter<span style="color:#ff79c6">:</span> <span style="color:#8be9fd;font-style:italic">function</span> (args) {
</span></span><span style="display:flex;"><span>      console.log(<span style="color:#f1fa8c">&#34;start function&#34;</span>);
</span></span><span style="display:flex;"><span>      console.log(JSON.stringify(<span style="color:#ff79c6">this</span>.context))
</span></span><span style="display:flex;"><span>      <span style="color:#6272a4">// å…·ä½“çš„å¯„å­˜å™¨å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>      conslole.log(<span style="color:#ff79c6">this</span>.context.x0)
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    onLeave<span style="color:#ff79c6">:</span> <span style="color:#8be9fd;font-style:italic">function</span> () {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  });
</span></span></code></pre></div><h2 id="ida-attach">IDA Attach</h2>
<blockquote>
<p>IDA yyds</p>
</blockquote>
<ol>
<li>æ‰‹æœºå¯åŠ¨ IDA Pro <code>dbgsrv</code> ä¸­çš„ android_server(x86_64 æˆ–è€… arm æ ¹æ®æœºå‹é€‰æ‹©)</li>
<li>ç«¯å£è½¬å‘</li>
<li>IDA Pro é¡¶æ  Debugger -&gt; Attach -&gt; Remote Android debugger</li>
</ol>
<p>éœ€è¦ç«¯å£è½¬å‘æ‰èƒ½attachï¼Œå°†androidç«¯å£è½¬å‘ä¸€ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adb forward tcp:23946 tcp:23946
</span></span></code></pre></div><h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a href="https://developer.android.com/reference/android/os/Bundle">Bundle Android Developers</a></li>
<li><a href="https://frida.re/docs/home/">Frida â€¢ A world-class dynamic instrumentation toolkit</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/520523247?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTg3NDkwNTMsImZpbGVHVUlEIjoiZ1hxbWRWdmJPRXNYcG8zbyIsImlhdCI6MTY5ODc0ODc1MywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODM1Mjk0Njk4M30.3D24gUz7Zah8RqqqLRzUIr5z1PlHm7nDF22mMsj6zBw">JNIåŠ¨æ€æ³¨å†Œã€é™æ€æ³¨å†Œå®ä¾‹åŠå…¶å®ç°åŸç†åˆ†æ</a></li>
</ul>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/android">Android</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        var disqus_shortname = 'ldrx30';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/ldrx30" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2024  Â© ldrx30 |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
