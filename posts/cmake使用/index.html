<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Cmakeä½¿ç”¨ - ldrx30</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="
ç¼–å†™è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬
" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Cmakeä½¿ç”¨" />
<meta property="og:description" content="
ç¼–å†™è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/cmake%E4%BD%BF%E7%94%A8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-09-09T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Cmakeä½¿ç”¨"/>
<meta name="twitter:description" content="
ç¼–å†™è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬
"/>
<script src="http://localhost:1313/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="http://localhost:1313/css/dark.d22e2a2879d933a4b781535fc4c4c716e9f9d35ea4986dd0cbabda82effc4bdd.css"  disabled />
	

	
	
		<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script>
	

	
	
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

		
		<script>
			document.addEventListener("DOMContentLoaded", function() {
					renderMathInElement(document.body, {
							delimiters: [
									{left: "$$", right: "$$", display: true},
									{left: "$", right: "$", display: false}
							]
					});
			});
			</script>
	

	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">ldrx30</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/about">About</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="http://localhost:1313/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Cmakeä½¿ç”¨</h1>
			<div class="meta">Posted on Sep 9, 2023</div>
		</div>
		

		

		<section class="body">
			<blockquote>
<p>ç¼–å†™è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬</p>
</blockquote>
<h2 id="makefile">Makefile</h2>
<p>åº”è¯¥å« GNU Makeï¼Œåœ¨Linux å¹³å°å¸¸ç”¨</p>
<p>æ‰“å°ä¿¡æ¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-make" data-lang="make"><span style="display:flex;"><span><span style="color:#6272a4"># ä¸æ˜¾ç¤ºä¸­é—´è¿‡ç¨‹ä»¥åŠå‘½ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>@echo <span style="color:#f1fa8c">&#34;begin make&#34;</span>
</span></span><span style="display:flex;"><span>@<span style="color:#ff79c6">$(</span><span style="color:#8be9fd;font-style:italic">CXX</span><span style="color:#ff79c6">)</span>  $^ -o <span style="color:#ff79c6">$(</span><span style="color:#8be9fd;font-style:italic">TARGET</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>@echo <span style="color:#f1fa8c">&#34;build success&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æŠ¥é”™å¤„ç†, æŠ¥é”™åä¸ä¼šå‘ä¸‹æ‰§è¡Œï¼Œæˆ‘ä»¬åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ª `-` ç¬¦å·å°±è¡Œ
</span></span></span></code></pre></div><p>é¡¹ç›®ç»“æ„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>hello/
</span></span><span style="display:flex;"><span>â”œâ”€â”€ main.cpp
</span></span><span style="display:flex;"><span>â”œâ”€â”€ factorial.cpp
</span></span><span style="display:flex;"><span>â”œâ”€â”€ printhello.cpp
</span></span><span style="display:flex;"><span>â””â”€â”€ functions.h
</span></span></code></pre></div><p>æœ´ç´ ç‰ˆ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>g++ main.cpp factorial.cpp printhello.cpp -o main
</span></span><span style="display:flex;"><span>./main
</span></span></code></pre></div><h3 id="version1">version1</h3>
<p>tabè€Œä¸æ˜¯ç©ºæ ¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#50fa7b">hello</span><span style="color:#ff79c6">:</span> main.cpp printhello.cpp factorial.cpp
</span></span><span style="display:flex;"><span>	g++ -o hello main.cpp printhello.cpp factorial.cpp
</span></span></code></pre></div><h3 id="version2">version2</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">CXX</span> <span style="color:#ff79c6">=</span> g++
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">TARGET</span> <span style="color:#ff79c6">=</span> hello 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">OBJ</span> <span style="color:#ff79c6">=</span> main.o printhello.o factorial.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">$(TARGET)</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">$(</span><span style="color:#8be9fd;font-style:italic">OBJ</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">$(</span>CXX<span style="color:#ff79c6">)</span> -o <span style="color:#ff79c6">$(</span>TARGET<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">$(</span>OBJ<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">main.o</span><span style="color:#ff79c6">:</span> main.cpp
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">$(</span>CXX<span style="color:#ff79c6">)</span> -c main.cpp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">printhello.o</span><span style="color:#ff79c6">:</span> printhello.cpp
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">$(</span>CXX<span style="color:#ff79c6">)</span> -c printhello.cpp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">factorial.o</span><span style="color:#ff79c6">:</span> factorial.cpp
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">$(</span>CXX<span style="color:#ff79c6">)</span> -c factorial.cpp
</span></span></code></pre></div><h3 id="version3">version3</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">CXX</span> <span style="color:#ff79c6">=</span> g++
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">TARGET</span> <span style="color:#ff79c6">=</span> hello 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">OBJ</span> <span style="color:#ff79c6">=</span> main.o printhello.o factorial.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Wall warning all
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">CXXFLAGS</span> <span style="color:#ff79c6">=</span> -c -Wall
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">$(TARGET)</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">$(</span><span style="color:#8be9fd;font-style:italic">OBJ</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">$(</span>CXX<span style="color:#ff79c6">)</span> -o <span style="color:#8be9fd;font-style:italic">$@</span> $^
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">%.o</span><span style="color:#ff79c6">:</span> %.cpp
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">$(</span>CXX<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">$(</span>CXXFLAGS<span style="color:#ff79c6">)</span> $&lt; -o <span style="color:#8be9fd;font-style:italic">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># PHONY é¿å…å†²çªã€‚æ¯”å¦‚æœ‰ä¸€ä¸ª clean çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Ÿ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#50fa7b">.PHONY</span><span style="color:#ff79c6">:</span> clean
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">clean</span><span style="color:#ff79c6">:</span>
</span></span><span style="display:flex;"><span>	rm -f *.o <span style="color:#ff79c6">$(</span>TARGET<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><h3 id="version4">version4</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">CXX</span> <span style="color:#ff79c6">=</span> g++
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">TARGET</span> <span style="color:#ff79c6">=</span> hello 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æ–‡ä»¶ä¸‹æ‰€æœ‰çš„cpp
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">SRC</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$(</span>wildcard *.cpp<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æ„æ€ä¸º SRCä¸­çš„.cppæ›¿æ¢ä¸º.o
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">OBJ</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$(</span>patsubst %.cpp, %.o, <span style="color:#ff79c6">$(</span>SRC<span style="color:#ff79c6">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">CXXFLAGS</span> <span style="color:#ff79c6">=</span> -c -Wall
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">$(TARGET)</span><span style="color:#ff79c6">:</span> <span style="color:#ff79c6">$(</span><span style="color:#8be9fd;font-style:italic">OBJ</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">$(</span>CXX<span style="color:#ff79c6">)</span> -o <span style="color:#8be9fd;font-style:italic">$@</span> $^
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">%.o</span><span style="color:#ff79c6">:</span> %.cpp
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">$(</span>CXX<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">$(</span>CXXFLAGS<span style="color:#ff79c6">)</span> $&lt; -o <span style="color:#8be9fd;font-style:italic">$@</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">.PHONY</span><span style="color:#ff79c6">:</span> clean
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">clean</span><span style="color:#ff79c6">:</span>
</span></span><span style="display:flex;"><span>	rm -f *.o <span style="color:#ff79c6">$(</span>TARGET<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><h2 id="cmake">CMake</h2>
<p>Linux å‘½ä»¤è¡Œï¼Œcmake <strong>ç”Ÿæˆ makefile</strong>ï¼Œç„¶ååœ¨ make ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cmake .
</span></span><span style="display:flex;"><span>$ make
</span></span></code></pre></div><p>Windows å‘½ä»¤è¡Œ</p>
<ol>
<li>MinGW ç¯å¢ƒï¼Œä¸æ˜¯æˆ‘çš„é€‰æ‹©ï¼Œ MSVC</li>
<li>CMakeï¼Œé¦–å…ˆç”Ÿæˆç¼“å­˜ï¼Œæœ€åç¼–è¯‘</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>cmake -B build
</span></span><span style="display:flex;"><span>cmake --build build
</span></span></code></pre></div><p>é…åˆ VsCode ä½¿ç”¨</p>
<p>Ctrl + shift + p è¿›å…¥å‘½ä»¤ ï¼š cmake build å°±èƒ½ç”Ÿæˆbuild ç›®å½•ï¼Œå‡ºç°æˆ‘ä»¬çš„éœ€è¦çš„exeæ–‡ä»¶</p>
<h3 id="è¯­æ³•">è¯­æ³•</h3>
<p>æœ€ç®€å•çš„ CmakeLists</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#6272a4">#[[ cmake ç‰ˆæœ¬è¦æ±‚ ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">cmake_minimum_required</span> (<span style="color:#f1fa8c">VERSION</span> <span style="color:#f1fa8c">3.0</span>) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ å·¥ç¨‹å ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">project</span> (<span style="color:#f1fa8c">test</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ å¯æ‰§è¡Œæ–‡ä»¶ ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">add_executable</span> (<span style="color:#f1fa8c">main</span> <span style="color:#f1fa8c">main.cpp</span>)
</span></span></code></pre></div><p>set è®¾ç½®å˜é‡</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">SET</span>(<span style="color:#f1fa8c">SRC</span> <span style="color:#f1fa8c">main.cpp</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">add_executable</span> (<span style="color:#f1fa8c">main</span> <span style="color:#ff79c6">${</span><span style="color:#8be9fd;font-style:italic">SRC</span><span style="color:#ff79c6">}</span>)
</span></span></code></pre></div><p>C/C++ æ ‡å‡† æ¯”å¦‚ <code>-std=c99</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">set</span>(<span style="color:#f1fa8c">CMAKE_C_STANDARD</span> <span style="color:#f1fa8c">11</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">set</span>(<span style="color:#f1fa8c">CMAKE_CXX_STANDARD</span> <span style="color:#f1fa8c">11</span>)
</span></span></code></pre></div><p>file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#6272a4">#[[ åŒ¹é…æ‰€æœ‰çš„æ–‡ä»¶å ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">file</span>(<span style="color:#f1fa8c">GLOB</span> <span style="color:#f1fa8c">&lt;variable&gt;</span> <span style="color:#f1fa8c">[LIST_DIRECTORIES</span> <span style="color:#f1fa8c">true[false]]</span> <span style="color:#f1fa8c">[RELATIVE</span> <span style="color:#f1fa8c">&lt;path&gt;</span> <span style="color:#f1fa8c">]</span> <span style="color:#f1fa8c">[CONFIGURE_DEPENDS]</span> <span style="color:#f1fa8c">[&lt;globbing-expression&gt;</span> <span style="color:#f1fa8c">...]</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ å°† /usr/lib/inlcude/ ä¸‹æ‰€æœ‰ cæ–‡ä»¶ èµ‹å€¼ç»™ SRC ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">file</span>(<span style="color:#f1fa8c">GLOB</span> <span style="color:#f1fa8c">SRC</span> <span style="color:#f1fa8c">/usr/lib/inlcude/*.c</span>)
</span></span></code></pre></div><p>å®</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#6272a4">#[[ å½“å‰CMakeListsæ‰€åœ¨æ–‡ä»¶å¤¹ ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>CMAKE_CURRENT_SOURCE_DIR 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ æœ€å¤–å±‚CMakeLists.txtæ‰€åœ¨ç›®å½• ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>CMAKE_SOURCE_DIR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ ç¦» CMakeLists.txt æœ€è¿‘çš„ä¸€å±‚æ–‡ä»¶å¤¹ ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>PROJECT_SOURCE_DIR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ äºŒè¿›åˆ¶æ–‡ä»¶è¾“å‡ºè·¯å¾„ï¼Œå¯è‡ªè¡Œset ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>EXECUTABLE_OUTPUT_PATH
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ åº“è¾“å‡ºè·¯å¾„ ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>LIBRARY_OUTPUT_PATH
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ ç¼–è¯‘å™¨ç¼–è¯‘é€‰é¡¹ ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>CMAKE_CXX_FLAGS
</span></span></code></pre></div><p>æ‰“å°ä¿¡æ¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">message</span>()
</span></span></code></pre></div><p>åˆ¶ä½œé“¾æ¥åº“</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">add_library</span>(<span style="color:#f1fa8c">&lt;name&gt;</span> <span style="color:#f1fa8c">[STATIC</span> <span style="color:#f1fa8c">|</span> <span style="color:#f1fa8c">SHARED</span> <span style="color:#f1fa8c">|</span> <span style="color:#f1fa8c">MODULE]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">[EXCLUDE_FROM_ALL]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f1fa8c">[source1]</span> <span style="color:#f1fa8c">[source2</span> <span style="color:#f1fa8c">...]</span>)
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[ STATIC(é™æ€åº“) SHARED(åŠ¨æ€åº“) MODULE(æ¨¡å—åº“) ]]
</span></span></span></code></pre></div><p>æ·»åŠ åº“ï¼Œç±»ä¼¼äº <code>gcc -lpthread</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">target_link_libraries</span>(<span style="color:#f1fa8c">main</span> <span style="color:#f1fa8c">pthread</span>)
</span></span></code></pre></div><h3 id="å¤šæ–‡ä»¶å¤¹">å¤šæ–‡ä»¶å¤¹</h3>
<p>åŒ…å«å¤´æ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">include_directories</span>(<span style="color:#ff79c6">${</span><span style="color:#8be9fd;font-style:italic">CMAKE_CURRENT_SOURCE_DIR</span><span style="color:#ff79c6">}</span><span style="color:#f1fa8c">/include/</span>)
</span></span></code></pre></div><p>åŒ…å«æºæ–‡ä»¶ï¼šfile</p>
<p>å¤šä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¯”å¦‚ç®€å•çš„ web æœåŠ¡å™¨</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ tree
</span></span><span style="display:flex;"><span>server
</span></span><span style="display:flex;"><span>|-- client
</span></span><span style="display:flex;"><span>|	|-- client.c
</span></span><span style="display:flex;"><span>|	|-- CMakeLists.txt
</span></span><span style="display:flex;"><span>|-- server
</span></span><span style="display:flex;"><span>|	|-- server.c
</span></span><span style="display:flex;"><span>|	|-- CMakeLists.txt
</span></span><span style="display:flex;"><span>|-- CMakeLists.txt
</span></span></code></pre></div><p>æ·»åŠ å­ç›®å½•ï¼Œè¦æ±‚å­ç›®å½•å¿…é¡»å«æœ‰ CmakeLists.txt</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#6272a4">#[[ åŒ…å«å­ç›®å½• ]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">add_subdirectory</span>(<span style="color:#f1fa8c">client</span>)
</span></span></code></pre></div><p>æœ€å¤–å±‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cmake_minimum_required</span> (<span style="color:#f1fa8c">VERSION</span> <span style="color:#f1fa8c">3.0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">project</span> (<span style="color:#f1fa8c">tftp</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">add_subdirectory</span>(<span style="color:#f1fa8c">client</span>)                
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">add_subdirectory</span>(<span style="color:#f1fa8c">server</span>)
</span></span></code></pre></div><p>clent &amp; server</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cmake_minimum_required</span> (<span style="color:#f1fa8c">VERSION</span> <span style="color:#f1fa8c">3.0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">project</span> (<span style="color:#f1fa8c">server</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">add_executable</span> (<span style="color:#f1fa8c">server</span> <span style="color:#f1fa8c">server.cpp</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#[[-----------------------------]]
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cmake_minimum_required</span> (<span style="color:#f1fa8c">VERSION</span> <span style="color:#f1fa8c">3.0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">project</span> (<span style="color:#f1fa8c">client</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">add_executable</span> (<span style="color:#f1fa8c">client</span> <span style="color:#f1fa8c">client.cpp</span>)
</span></span></code></pre></div><h3 id="ç¼–è¯‘æˆåº“">ç¼–è¯‘æˆåº“</h3>
<p>å°†includeç¼–è¯‘æˆåº“ï¼Œç„¶ååœ¨ç¼–è¯‘æ—¶æŒ‡å®šåº“ (packet: ç½‘ç»œæ•°æ®åŒ…ï¼Œåœ¨client å’Œ server éƒ½ä¼šä½¿ç”¨)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">ADD_LIBRARY</span>(<span style="color:#f1fa8c">packet</span> <span style="color:#f1fa8c">STATIC</span> <span style="color:#f1fa8c">packet.cpp</span>)
</span></span></code></pre></div><p>é¡¹ç›®æ·»åŠ åŠ¨æ€é“¾æ¥åº“ï¼šåŒ…å«åº“ + äºŒè¿›åˆ¶æ–‡ä»¶é“¾æ¥</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">link_directories</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">${</span><span style="color:#8be9fd;font-style:italic">CMAKE_SOURCE_DIR</span><span style="color:#ff79c6">}</span><span style="color:#f1fa8c">/lib</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">target_link_libraries</span>(<span style="color:#f1fa8c">client</span> <span style="color:#f1fa8c">PUBLIC</span> <span style="color:#f1fa8c">packet</span>)
</span></span></code></pre></div><h3 id="æ·»åŠ cppæ–‡ä»¶">æ·»åŠ cppæ–‡ä»¶</h3>
<p>æˆ–è®¸æœ€ç®€å•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å®å’Œå‡½æ•°è·å–cppæ–‡ä»¶æ·»åŠ </p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmake" data-lang="cmake"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">add_executable</span> (<span style="color:#f1fa8c">client</span> <span style="color:#f1fa8c">client.cpp</span> <span style="color:#ff79c6">${</span><span style="color:#8be9fd;font-style:italic">CMAKE_SOURCE_DIR</span><span style="color:#ff79c6">}</span><span style="color:#f1fa8c">/packet/packet.cpp</span>)
</span></span></code></pre></div><h2 id="debug">debug</h2>
<blockquote>
<p>ä¸»è¦æ˜¯åœ¨ vscode ä¸­é…åˆ LLVM å·¥å…·é“¾è¿›è¡Œdebugã€‚~~CLion å•¥éƒ½æœ‰ğŸ«¢ ~~</p>
</blockquote>
<p>ç¯å¢ƒï¼švscode + llvm + clangdæ’ä»¶ + code-lldbæ’ä»¶</p>
<ul>
<li>å†™å¥½ä¸€ä¸ªcmakeå·¥ç¨‹</li>
</ul>
<p>f5 è¿›è¡Œè°ƒè¯•ï¼Œéœ€è¦æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ª <code>.vscode</code> æ–‡ä»¶å¤¹ï¼Œé…ç½®<code>launch.json</code>ã€‚å…¶ä¸­æœ‰ä¸€ä¸ªå±æ€§ï¼š<code>program</code> ä¿®æ”¹ä¸ºæˆ‘ä»¬çš„ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶å°±è¡Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>	...
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;configurations&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;lldb&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;request&#34;</span>: <span style="color:#f1fa8c">&#34;launch&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;windows&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;program&#34;</span>: <span style="color:#f1fa8c">&#34;${workspaceFolder}/build/Debug/test.exe&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;args&#34;</span>: [],
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&#34;cwd&#34;</span>: <span style="color:#f1fa8c">&#34;${workspaceFolder}&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>    ...
</span></span></code></pre></div><p>lldb æŒ‡ä»¤å’Œ gdb ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸‹é¢çš„ debug çª—å£ è¿›è¡Œå•æ­¥æ‰§è¡Œ</p>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/cmake">cmake</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        var disqus_shortname = 'ldrx30';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/ldrx30" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2024  Â© ldrx30 |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
